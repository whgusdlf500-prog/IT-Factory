<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Chooser | Laptop Â· Phone Â· Robot Â· Headphones Â· Keyboard</title>
  <meta name="description" content="Local-only product chooser with AI-style generated visuals, scored recommendations, favorites and comparison." />
  <meta name="theme-color" content="#0b1220" />

  <style>
    :root{
      --bg:#0b1220;
      --card:#0f1a2e;
      --text:#eaf0ff;
      --muted:#a7b6d9;
      --line:rgba(255,255,255,.10);
      --acc:#7aa2ff;
      --acc2:#b08cff;
      --good:#6ee7b7;
      --warn:#fde68a;
      --bad:#fb7185;
      --shadow: 0 18px 70px rgba(0,0,0,.45);
      --radius: 22px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo","Noto Sans KR","Malgun Gothic", Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1100px 600px at 18% 8%, rgba(122,162,255,.24), transparent 62%),
        radial-gradient(900px 600px at 84% 18%, rgba(176,140,255,.18), transparent 60%),
        radial-gradient(900px 520px at 60% 96%, rgba(110,231,183,.11), transparent 60%),
        linear-gradient(180deg, #070b14, var(--bg));
      min-height:100vh;
      overflow-x:hidden;
    }
    .wrap{max-width:1260px;margin:0 auto;padding:26px 18px 120px}
    header{
      display:flex;gap:14px;align-items:center;justify-content:space-between;flex-wrap:wrap;
      padding:16px 18px;border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      position:relative;
      overflow:hidden;
    }
    header:after{
      content:"";
      position:absolute; inset:-80% -40%;
      background: conic-gradient(from 180deg, rgba(255,255,255,0), rgba(255,255,255,.14), rgba(255,255,255,0));
      animation: headerShine 11s linear infinite;
      opacity:.55;
      pointer-events:none;
    }
    @keyframes headerShine{to{transform:rotate(360deg)}}

    .brand{display:flex;align-items:center;gap:12px;position:relative;z-index:1}
    .logo{
      width:44px;height:44px;border-radius:14px;
      background:
        radial-gradient(18px 18px at 30% 30%, rgba(255,255,255,.55), transparent 60%),
        linear-gradient(135deg, rgba(122,162,255,.95), rgba(176,140,255,.95));
      box-shadow: 0 12px 40px rgba(122,162,255,.20);
      position:relative;overflow:hidden;flex:0 0 auto;
    }
    .logo:after{
      content:"";position:absolute;inset:-40%;
      background: conic-gradient(from 180deg, rgba(255,255,255,.0), rgba(255,255,255,.18), rgba(255,255,255,.0));
      animation: spin 7s linear infinite;
    }
    @keyframes spin{to{transform:rotate(360deg)}}
    .title h1{margin:0;font-size:16px;letter-spacing:.2px}
    .title p{margin:2px 0 0;color:var(--muted);font-size:12.5px;line-height:1.45}

    .pillrow{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end;align-items:center;position:relative;z-index:1}
    .pill{
      padding:8px 10px;border:1px solid var(--line);
      border-radius:999px;background: rgba(255,255,255,.04);
      color:var(--muted);font-size:12px;display:flex;gap:7px;align-items:center;
    }
    .dot{width:7px;height:7px;border-radius:99px;background: var(--good);box-shadow: 0 0 0 4px rgba(110,231,183,.12)}
    .lang{
      display:flex;gap:6px;align-items:center;
      padding:6px;border:1px solid var(--line);
      border-radius:999px;background:rgba(255,255,255,.03);
    }
    .lang button{
      cursor:pointer;border:1px solid transparent;
      padding:8px 10px;border-radius:999px;
      background:transparent;color:var(--muted);
      font-weight:900;font-size:12px;
      transition:.12s background,.12s border-color,.12s transform;
      user-select:none;
    }
    .lang button:hover{transform:translateY(-1px);background:rgba(255,255,255,.04)}
    .lang button.active{
      color:var(--text);
      border-color: rgba(122,162,255,.45);
      background: linear-gradient(135deg, rgba(122,162,255,.18), rgba(176,140,255,.10));
    }

    .grid{display:grid;grid-template-columns: 1.06fr .94fr;gap:16px;margin-top:16px}
    @media (max-width: 980px){.grid{grid-template-columns:1fr}}

    .card{
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:16px 18px;border-bottom:1px solid var(--line);
      display:flex;align-items:flex-start;justify-content:space-between;gap:10px;flex-wrap:wrap;
      background: linear-gradient(180deg, rgba(122,162,255,.10), transparent);
    }
    .card .hd h2{margin:0;font-size:14.5px}
    .card .hd .sub{color:var(--muted);font-size:12px;line-height:1.55;margin-top:6px}

    .tabs{display:flex;gap:8px;flex-wrap:wrap}
    .tab{
      cursor:pointer;
      padding:10px 12px;border-radius:999px;border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      color:var(--muted);
      font-size:13px;
      display:flex;gap:8px;align-items:center;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;white-space:nowrap;
    }
    .tab:hover{transform: translateY(-1px);border-color: rgba(255,255,255,.18)}
    .tab.active{
      color: var(--text);
      border-color: rgba(122,162,255,.45);
      background: linear-gradient(135deg, rgba(122,162,255,.18), rgba(176,140,255,.10));
      box-shadow: 0 12px 40px rgba(122,162,255,.12);
    }
    .body{padding:18px}

    .controls{
      display:grid;grid-template-columns: 1fr 1fr; gap:10px;
      margin-bottom:12px;
    }
    @media (max-width: 560px){.controls{grid-template-columns:1fr}}
    .control{
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius: 16px;
      padding:10px 10px;
      display:flex;flex-direction:column;gap:6px;
    }
    .control .lab{font-size:12px;color:var(--muted);font-weight:900}
    .control input, .control select{
      width:100%;
      padding:10px 10px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(10,17,33,.55);
      color: var(--text);
      outline:none;
      font-weight:850;
    }

    .toggles{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .sectionLabel{
      font-size:12px;
      color:var(--muted);
      font-weight:900;
      margin-top:12px;
    }
    .toggle{
      cursor:pointer;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius: 999px;
      padding:9px 10px;
      font-size:12px;
      font-weight:950;
      color: var(--muted);
      user-select:none;
      transition: .12s transform, .12s border-color, .12s background;
    }
    .toggle:hover{transform: translateY(-1px); border-color: rgba(255,255,255,.20)}
    .toggle.active{
      color: var(--text);
      border-color: rgba(122,162,255,.45);
      background: linear-gradient(135deg, rgba(122,162,255,.18), rgba(176,140,255,.10));
    }

    .ctaRow{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px;align-items:center}
    .btn{
      cursor:pointer;border:1px solid var(--line);
      padding:11px 12px;border-radius: 14px;
      background: rgba(255,255,255,.03);
      color: var(--text);
      font-weight:950;letter-spacing:.2px;
      transition: transform .12s ease, border-color .12s ease, background .12s ease, filter .12s ease;
      user-select:none;white-space:nowrap;
    }
    .btn:hover{transform: translateY(-1px);border-color: rgba(255,255,255,.22); filter:saturate(1.05)}
    .btn.primary{
      border-color: rgba(122,162,255,.50);
      background: linear-gradient(135deg, rgba(122,162,255,.28), rgba(176,140,255,.20));
      box-shadow: 0 14px 50px rgba(122,162,255,.12);
    }
    .btn.ghost{color:var(--muted)}
    .btn.danger{
      border-color: rgba(251,113,133,.35);
      background: rgba(251,113,133,.08);
      color: rgba(255,232,236,.96);
    }

    .note{
      margin-top:12px;color: var(--muted);
      font-size:12.3px;line-height:1.65;
    }

    .q{
      padding:14px;border:1px solid var(--line);
      background: rgba(10,17,33,.45);
      border-radius: 18px;
      margin-top:12px;
      position:relative;
      overflow:hidden;
    }
    .q:after{
      content:"";
      position:absolute; inset:-60% -30%;
      background: radial-gradient(600px 220px at 30% 20%, rgba(122,162,255,.18), transparent 60%);
      pointer-events:none;
      opacity:.55;
    }
    .q label{display:block;font-size:13.5px;margin-bottom:8px;font-weight:950; position:relative; z-index:1}
    .q .qsub{color:var(--muted);font-size:12px;line-height:1.55;margin-top:-2px;margin-bottom:10px; position:relative; z-index:1}
    .opts{display:flex;flex-wrap:wrap;gap:8px; position:relative; z-index:1}
    .opt{
      flex: 1 1 auto;min-width: 160px;cursor:pointer;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--muted);
      padding:10px 10px;border-radius: 14px;
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
      user-select:none;
    }
    .opt:hover{transform: translateY(-1px);border-color: rgba(255,255,255,.20)}
    .opt.active{
      color: var(--text);
      border-color: rgba(110,231,183,.45);
      background: linear-gradient(180deg, rgba(110,231,183,.10), rgba(255,255,255,.02));
    }
    .opt small{color:var(--muted)}

    .kpis{
      display:grid;grid-template-columns: repeat(3, 1fr);
      gap:10px;padding:14px 18px;
      border-top: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01));
    }
    @media (max-width: 520px){.kpis{grid-template-columns:1fr}}
    .kpi{
      border:1px solid var(--line);
      border-radius: 18px;padding:12px 12px;
      background: rgba(255,255,255,.03);
    }
    .kpi .k{color:var(--muted);font-size:12px}
    .kpi .v{font-size:14px;font-weight:1000;margin-top:4px;letter-spacing:-.01em}

    .results{display:flex;flex-direction:column;gap:12px}

    /* Product card: premium 3D tilt + glass highlight */
    .item{
      border:1px solid rgba(255,255,255,.12);
      border-radius: 22px;
      padding:14px;
      background:
        radial-gradient(900px 180px at 10% 0%, rgba(122,162,255,.14), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      display:flex;gap:12px;flex-direction:column;
      position:relative;overflow:hidden;
      transform-style: preserve-3d;
      transition: transform .16s ease, border-color .16s ease, box-shadow .16s ease;
      will-change: transform;
    }
    .item:before{
      content:"";
      position:absolute; inset:-1px;
      background:
        radial-gradient(420px 120px at var(--mx, 30%) var(--my, 15%), rgba(255,255,255,.16), transparent 60%),
        radial-gradient(520px 160px at 80% 10%, rgba(176,140,255,.10), transparent 60%);
      pointer-events:none;
      mix-blend-mode: screen;
      opacity:.9;
      transform: translateZ(25px);
    }
    .item:after{
      content:"";
      position:absolute; inset:-70% -30%;
      background: conic-gradient(from 180deg, rgba(255,255,255,0), rgba(255,255,255,.14), rgba(255,255,255,0));
      opacity:.50;
      transform: translateZ(18px) rotate(0deg);
      animation: shine 12s linear infinite;
      pointer-events:none;
    }
    @keyframes shine{to{transform: translateZ(18px) rotate(360deg)}}
    .item:hover{
      border-color: rgba(255,255,255,.20);
      box-shadow: 0 28px 100px rgba(0,0,0,.56);
    }

    .heroImg{
      width:100%;
      aspect-ratio:4/3;
      border-radius:18px;
      overflow:hidden;
      margin-bottom:10px;
      background:#111;
      max-height:180px;
      transform: translateZ(18px);
    }
    .heroImg img{
      width:100%;
      height:100%;
      object-fit:cover;
      transition:transform .25s ease;
    }
    .item:hover .heroImg img{
      transform:scale(1.06);
    }
    .heroTitle{
      margin:0 0 6px;
      font-size:17px;
      font-weight:900;
    }
    .heroPrice{
      font-size:13px;
      color: rgba(255,255,255,.9);
      margin:0 0 6px;
      font-weight:800;
    }
    .heroDesc{
      color:var(--muted);
      font-size:13px;
      line-height:1.5;
    }
    .heroBody{transform: translateZ(10px)}
    .brandPill{
      display:inline-flex;align-items:center;gap:6px;
      padding:6px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.03);
      font-size:12px;font-weight:950;
      color: var(--text);
      margin:8px 0 6px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    .brandDot{
      width:10px;height:10px;border-radius:999px;background: var(--brand,#7aa2ff);
      box-shadow: 0 0 0 4px color-mix(in srgb, var(--brand,#7aa2ff) 30%, transparent);
    }
    .brandLogo{
      width:14px;height:14px;display:inline-block;
    }
    .brandLink{
      margin-left:6px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      color: var(--text);
      padding:2px 6px;
      border-radius:999px;
      font-size:10.5px;
      text-decoration:none;
    }

    .meta{min-width:0;flex:1;transform: translateZ(10px)}
    .meta .name{font-weight:1100;font-size:14px;margin:0 0 6px;letter-spacing:-.01em}
    .meta .line{color:var(--muted);font-size:12.2px;line-height:1.45;margin:0}
    .badgerow{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}

    .chip{
      padding:7px 9px;border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--muted);
      font-size:11.5px;font-weight:950;
      white-space:nowrap;
    }
    .chip.good{border-color: rgba(110,231,183,.25); background: rgba(110,231,183,.08); color: rgba(234,255,246,.92);}
    .chip.warn{border-color: rgba(253,230,138,.25); background: rgba(253,230,138,.08); color: rgba(255,248,222,.92);}
    .chip.bad{border-color: rgba(251,113,133,.25); background: rgba(251,113,133,.08); color: rgba(255,232,236,.92);}

    .badge{
      flex:0 0 auto;align-self:flex-start;
      padding:8px 10px;border-radius: 999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--muted);
      font-size:12px;display:flex;gap:8px;align-items:center;white-space:nowrap;
      transform: translateZ(10px);
    }

    .scorebar{
      height:10px;border-radius: 999px;
      background: rgba(255,255,255,.06);
      border: 1px solid var(--line);
      overflow:hidden;margin-top:10px;
      transform: translateZ(8px);
    }
    .scorebar > div{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, rgba(110,231,183,.75), rgba(122,162,255,.75), rgba(176,140,255,.75));
      border-radius: 999px;
      transition: width .35s ease;
    }

    .itemActions{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px;transform: translateZ(8px)}
    .miniBtn{
      cursor:pointer;border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--text);
      border-radius: 12px;
      padding:8px 9px;
      font-size:12px;
      font-weight:950;
      user-select:none;
      transition:.12s transform,.12s border-color, .12s filter;
      text-decoration:none;
      display:inline-flex;align-items:center;gap:8px;
    }
    .miniBtn:hover{transform: translateY(-1px); border-color: rgba(255,255,255,.20); filter:saturate(1.08)}
    .miniBtn.star.active{
      border-color: rgba(253,230,138,.35);
      background: rgba(253,230,138,.10);
      color: rgba(255,248,222,.96);
    }
    .miniBtn.cmp.active{
      border-color: rgba(122,162,255,.45);
      background: rgba(122,162,255,.12);
    }
    .miniBtn.ai{
      border-color: rgba(176,140,255,.40);
      background: rgba(176,140,255,.10);
      color: rgba(242,236,255,.96);
    }

    .sep{height:1px;background: var(--line);margin:12px 0}
    .mini{
      border:1px solid var(--line);
      background: rgba(255,255,255,.02);
      border-radius: 16px;
      padding:12px;margin-top:10px;
    }
    .split{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between}
    .right{display:flex;gap:8px;flex-wrap:wrap}
    footer{
      margin-top:16px;color: var(--muted);
      font-size:12px;line-height:1.7;
      padding:14px 2px 0;
    }

    /* Compare drawer */
    .drawer{
      position:fixed;left:0; right:0;bottom:0;
      transform: translateY(110%);
      transition: transform .22s ease;
      z-index: 50;
      padding: 14px;
    }
    .drawer.open{transform: translateY(0)}
    .drawerCard{
      max-width: 1260px;margin:0 auto;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(8,12,22,.88);
      border-radius: 20px;
      box-shadow: 0 24px 90px rgba(0,0,0,.55);
      backdrop-filter: blur(12px);
      overflow:hidden;
    }
    .drawerHd{
      padding:12px 14px;
      display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .drawerHd .t{font-weight:1050}
    .drawerBody{padding: 12px 14px 14px}
    .cmpTop{
      display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between;
      margin-bottom:10px;
    }
    .cmpPills{display:flex;gap:8px;flex-wrap:wrap}
    .cmpPill{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      border-radius:999px;
      padding:8px 10px;
      font-size:12px;
      color:var(--muted);
      display:flex;gap:8px;align-items:center;
    }
    .cmpTableWrap{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      border-radius: 16px;
      overflow:auto;
    }
    table.cmp{
      width:100%;
      border-collapse:collapse;
      min-width: 760px;
    }
    table.cmp th, table.cmp td{
      border-bottom: 1px solid rgba(255,255,255,.08);
      padding:10px 12px;
      text-align:left;
      vertical-align:top;
      font-size:12.5px;
      line-height:1.55;
    }
    table.cmp th{
      position:sticky;top:0;
      background: rgba(8,12,22,.92);
      backdrop-filter: blur(10px);
      z-index: 2;
      font-weight:1050;
      color: var(--text);
    }
    table.cmp td:first-child{
      color: var(--muted);
      font-weight:950;
      width: 180px;
      background: rgba(8,12,22,.55);
      position:sticky;left:0;
      z-index: 1;
    }
    table.cmp th:first-child{left:0;z-index:3}

    /* Lightbox */
    .lightbox{
      position:fixed; inset:0;
      background: rgba(0,0,0,.62);
      display:none;
      align-items:center; justify-content:center;
      padding: 18px;
      z-index: 70;
      backdrop-filter: blur(10px);
    }
    .lightbox.open{display:flex}
    .lbCard{
      width: min(980px, 100%);
      border-radius: 22px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(8,12,22,.92);
      box-shadow: 0 28px 110px rgba(0,0,0,.65);
      overflow:hidden;
    }
    .lbHd{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      padding: 12px 14px;
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .lbHd .ttl{font-weight:1050}
    .lbHd .x{
      cursor:pointer;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      color: var(--text);
      border-radius: 14px;
      padding: 10px 12px;
      font-weight: 950;
    }
    .lbBody{padding: 14px;}
    .lbImgWrap{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      overflow:hidden;
    }
    .lbImgWrap img{width:100%; height:auto; display:block;}
    .lbCap{
      margin-top:10px;
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.6;
    }

    .toast{
      position: fixed;
      left: 50%;
      bottom: 14px;
      transform: translateX(-50%);
      background: rgba(8,12,22,.78);
      border: 1px solid rgba(255,255,255,.12);
      padding: 10px 12px;
      border-radius: 14px;
      color: var(--text);
      font-size: 12.5px;
      box-shadow: 0 18px 70px rgba(0,0,0,.45);
      backdrop-filter: blur(10px);
      display:none;
      max-width: min(980px, calc(100vw - 24px));
      z-index: 90;
    }

    /* subtle floating */
    .floaty{
      animation: floaty 6.5s ease-in-out infinite;
    }
    @keyframes floaty{
      0%,100%{transform:translateY(0)}
      50%{transform:translateY(-2px)}
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div class="title">
          <h1 id="uiTitle">ì„ íƒë„ìš°ë¯¸: ë…¸íŠ¸ë¶ Â· í•¸ë“œí° Â· ë¡œë´‡ì²­ì†Œê¸° Â· í—¤ë“œí° Â· í‚¤ë³´ë“œ</h1>
          <p id="uiSubtitle">ì§ˆë¬¸ ëª‡ ê°œ â†’ ì ìˆ˜ ê¸°ë°˜ ì¶”ì²œ + ê²€ìƒ‰/ì •ë ¬/ì¦ê²¨ì°¾ê¸°/ë¹„êµ Â· ì´ë¯¸ì§€ë„ ë¡œì»¬ì—ì„œ â€œAI ëŠë‚Œâ€ìœ¼ë¡œ ìƒì„±</p>
        </div>
      </div>

      <div class="pillrow">
        <div class="lang" aria-label="Language">
          <button id="lang_ko" class="active">í•œêµ­ì–´</button>
          <button id="lang_en">English</button>
        </div>
        <div class="pill"><span class="dot"></span> <span id="pillLocal">ë¡œì»¬ ê³„ì‚° Â· ì„œë²„ ì—…ë¡œë“œ ì—†ìŒ</span></div>
        <div class="pill"><span id="pillPrice">ê°€ê²©ì€ ì°¸ê³ ê°€(ëŒ€ëµ) Â· ìµœì¢…ì€ íŒë§¤ì²˜ í™•ì¸</span></div>
      </div>
    </header>

    <div class="grid">
      <!-- Left -->
      <section class="card">
        <div class="hd">
          <div>
            <h2 id="leftTitle">ğŸ§  ì§ˆë¬¸</h2>
            <div class="sub" id="leftSub">íƒ­ì„ ë°”ê¾¸ë©´ ì§ˆë¬¸/í•„í„°/ì œí’ˆ ë¦¬ìŠ¤íŠ¸ê°€ í•¨ê»˜ ë°”ë€ë‹ˆë‹¤.</div>
          </div>
          <div class="tabs" id="tabs"></div>
        </div>

        <div class="body">
          <div class="controls">
            <div class="control">
              <div class="lab" id="labSearch">ê²€ìƒ‰</div>
              <input id="searchBox" type="text" placeholder="ì˜ˆ: ë°°í„°ë¦¬, ANC, í•«ìŠ¤ì™‘, 2.4Gâ€¦" />
            </div>
            <div class="control">
              <div class="lab" id="labSort">ì •ë ¬</div>
              <select id="sortSel">
                <option value="score_desc">ì ìˆ˜ ë†’ì€ ìˆœ</option>
                <option value="price_asc">ê°€ê²© ë‚®ì€ ìˆœ</option>
                <option value="price_desc">ê°€ê²© ë†’ì€ ìˆœ</option>
                <option value="name_asc">ì´ë¦„ Aâ†’Z</option>
              </select>
            </div>
          </div>

          <div class="toggles" id="featureToggles"></div>
          <div class="sectionLabel" id="brandLabel">ì œì¡°ì‚¬</div>
          <div class="toggles" id="brandToggles"></div>

          <div class="ctaRow">
            <button class="btn primary" id="btnRun">ì¶”ì²œ ë§Œë“¤ê¸°</button>
            <button class="btn" id="btnSample">ìƒ˜í”Œ ë‹µì•ˆ</button>
            <button class="btn" id="btnShare">ì´ ìƒíƒœ ê³µìœ </button>
            <button class="btn ghost" id="btnReset">ì´ˆê¸°í™”</button>
          </div>

          <div class="note" id="noteText">
            âœ… ì¶”ì²œ/ê²€ìƒ‰/ì •ë ¬/ë¹„êµëŠ” ì „ë¶€ ë¸Œë¼ìš°ì €ì—ì„œë§Œ ì²˜ë¦¬ë©ë‹ˆë‹¤.<br/>
            âœ¨ ì œí’ˆ ì´ë¯¸ì§€ëŠ” â€œAI ë Œë” ëŠë‚Œâ€ìœ¼ë¡œ ë¸Œë¼ìš°ì €ì—ì„œ ì¦‰ì„ ìƒì„±ë©ë‹ˆë‹¤(ì™¸ë¶€ íŒŒì¼/ì„œë²„ ì—†ìŒ).<br/>
            âš ï¸ ê°€ê²©ì€ â€œì°¸ê³ ê°€(ëŒ€ëµ)â€ì´ë©° íŒë§¤ì²˜ì—ì„œ ìµœì¢… í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.
          </div>

          <div id="qArea"></div>
        </div>

        <div class="kpis">
          <div class="kpi">
            <div class="k" id="kCatLabel">ì¹´í…Œê³ ë¦¬</div>
            <div class="v" id="kCat">-</div>
          </div>
          <div class="kpi">
            <div class="k" id="kUpdatedLabel">ì—…ë°ì´íŠ¸</div>
            <div class="v" id="kUpdated">-</div>
          </div>
          <div class="kpi">
            <div class="k" id="kFavLabel">ì¦ê²¨ì°¾ê¸°</div>
            <div class="v" id="kFav">0</div>
          </div>
        </div>
      </section>

      <!-- Right -->
      <aside class="card">
        <div class="hd">
          <div>
            <h2 id="rightTitle">âœ¨ ê²°ê³¼</h2>
            <div class="sub" id="rightSub">ìƒìœ„ ì¶”ì²œ + ì´ìœ  + ì¦ê²¨ì°¾ê¸°/ë¹„êµ + AI ëŠë‚Œ ì´ë¯¸ì§€</div>
          </div>
          <div class="right">
            <button class="btn ghost" id="btnFavOnly">ì¦ê²¨ì°¾ê¸°ë§Œ</button>
            <button class="btn" id="btnClearCompare">ë¹„êµ ë¹„ìš°ê¸°</button>
          </div>
        </div>

        <div class="body">
          <div class="results" id="resultArea"></div>

          <div class="mini" id="sources">
            <div class="split">
              <div>
                <div style="font-weight:1100" id="legalTitle">ë©´ì±…/ê³ ì§€</div>
                <div class="muted" id="legalText" style="font-size:12px;line-height:1.6">
                  ê°€ê²©/ì¬ê³ /í˜œíƒì€ ë³€ë™ë  ìˆ˜ ìˆëŠ” ì°¸ê³  ì •ë³´ì…ë‹ˆë‹¤. ìµœì¢… íŒë‹¨ì€ íŒë§¤ì²˜/ì œì¡°ì‚¬ ì •ë³´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•˜ì„¸ìš”.
                </div>
              </div>
            </div>
            <div class="sep"></div>
            <div class="muted" style="font-size:12px" id="refFoot">
              âœ”ï¸ ì„¤ëª… ë¬¸êµ¬ëŠ” ì§ì ‘ ìš”ì•½ì´ë©°, í‘œ/ì´ë¯¸ì§€ ìŠ¤í¬ë˜í•‘ì€ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br/>
              âœ”ï¸ ì œí’ˆëª…ì€ ì„¤ëª… ëª©ì ì˜ í‘œê¸°ì´ë©° ìƒí‘œëŠ” ê° ì†Œìœ ìì—ê²Œ ìˆìŠµë‹ˆë‹¤.
            </div>
          </div>

          <footer id="footerNote">
            <b id="footerB">íŒ</b><br/>
            <span id="footerT">ë¹„êµ(í‘œ)ë¥¼ ì—´ê³  ì‹¶ìœ¼ë©´ ì¹´ë“œì—ì„œ â€˜ë¹„êµâ€™ë¥¼ 2~3ê°œ ë‹´ì•„ì£¼ì„¸ìš”.</span>
          </footer>
        </div>
      </aside>
    </div>
  </div>

  <!-- Compare drawer -->
  <div class="drawer" id="drawer">
    <div class="drawerCard">
      <div class="drawerHd">
        <div class="t" id="cmpTitle">ë¹„êµ(ìµœëŒ€ 3ê°œ) Â· í‘œ í˜•íƒœ</div>
        <div class="right">
          <button class="btn ghost" id="btnCloseDrawer">ë‹«ê¸°</button>
        </div>
      </div>
      <div class="drawerBody">
        <div class="cmpTop">
          <div class="cmpPills" id="cmpPills"></div>
          <div class="right">
            <button class="btn" id="btnOpenLinks">ì„ íƒ í•­ëª© ì—´ê¸°</button>
            <button class="btn danger" id="btnRemoveAll">ì „ë¶€ ì œê±°</button>
          </div>
        </div>
        <div class="cmpTableWrap" id="cmpTableWrap"></div>
      </div>
    </div>
  </div>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <div class="lbCard">
      <div class="lbHd">
        <div class="ttl" id="lbTitle">Preview</div>
        <button class="x" id="lbClose">ë‹«ê¸°</button>
      </div>
      <div class="lbBody">
        <div class="lbImgWrap">
          <img id="lbImg" alt="preview" />
        </div>
        <div class="lbCap" id="lbCap"></div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    // ===========================
    // i18n
    // ===========================
    const I18N = {
      ko:{
        uiTitle:"ì„ íƒë„ìš°ë¯¸: ë…¸íŠ¸ë¶ Â· í•¸ë“œí° Â· ë¡œë´‡ì²­ì†Œê¸° Â· í—¤ë“œí° Â· í‚¤ë³´ë“œ",
        uiSubtitle:"ì§ˆë¬¸ ëª‡ ê°œ â†’ ì ìˆ˜ ê¸°ë°˜ ì¶”ì²œ + ê²€ìƒ‰/ì •ë ¬/ì¦ê²¨ì°¾ê¸°/ë¹„êµ Â· ì´ë¯¸ì§€ë„ ë¡œì»¬ì—ì„œ â€œAI ëŠë‚Œâ€ìœ¼ë¡œ ìƒì„±",
        pillLocal:"ë¡œì»¬ ê³„ì‚° Â· ì„œë²„ ì—…ë¡œë“œ ì—†ìŒ",
        pillPrice:"ê°€ê²©ì€ ì°¸ê³ ê°€(ëŒ€ëµ) Â· ìµœì¢…ì€ íŒë§¤ì²˜ í™•ì¸",
        leftTitle:"ğŸ§  ì§ˆë¬¸",
        leftSub:"íƒ­ì„ ë°”ê¾¸ë©´ ì§ˆë¬¸/í•„í„°/ì œí’ˆ ë¦¬ìŠ¤íŠ¸ê°€ í•¨ê»˜ ë°”ë€ë‹ˆë‹¤.",
        labSearch:"ê²€ìƒ‰",
        labSort:"ì •ë ¬",
        sort:{score_desc:"ì ìˆ˜ ë†’ì€ ìˆœ",price_asc:"ê°€ê²© ë‚®ì€ ìˆœ",price_desc:"ê°€ê²© ë†’ì€ ìˆœ",name_asc:"ì´ë¦„ Aâ†’Z"},
        placeholderSearch:"ì˜ˆ: ë°°í„°ë¦¬, ANC, í•«ìŠ¤ì™‘, 2.4Gâ€¦",
        btnRun:"ì¶”ì²œ ë§Œë“¤ê¸°",
        btnSample:"ìƒ˜í”Œ ë‹µì•ˆ",
        btnShare:"ì´ ìƒíƒœ ê³µìœ ",
        btnReset:"ì´ˆê¸°í™”",
        note:"âœ… ì¶”ì²œ/ê²€ìƒ‰/ì •ë ¬/ë¹„êµëŠ” ì „ë¶€ ë¸Œë¼ìš°ì €ì—ì„œë§Œ ì²˜ë¦¬ë©ë‹ˆë‹¤.<br/>âœ¨ ì œí’ˆ ì´ë¯¸ì§€ëŠ” â€œAI ë Œë” ëŠë‚Œâ€ìœ¼ë¡œ ë¸Œë¼ìš°ì €ì—ì„œ ì¦‰ì„ ìƒì„±ë©ë‹ˆë‹¤(ì™¸ë¶€ íŒŒì¼/ì„œë²„ ì—†ìŒ).<br/>ğŸ§­ ì‚¬ìš©ë²•: 1) íƒ­ ì„ íƒ â†’ 2) ì§ˆë¬¸ ë‹µë³€ â†’ 3) â€˜ì¶”ì²œ ë§Œë“¤ê¸°â€™ í´ë¦­ (í•„í„°/ê²€ìƒ‰ì€ ì„ íƒ).<br/>âš ï¸ ê°€ê²©ì€ â€œì°¸ê³ ê°€(ëŒ€ëµ)â€ì´ë©° íŒë§¤ì²˜ì—ì„œ ìµœì¢… í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.",
        kCatLabel:"ì¹´í…Œê³ ë¦¬",
        kUpdatedLabel:"ì—…ë°ì´íŠ¸",
        kFavLabel:"ì¦ê²¨ì°¾ê¸°",
        rightTitle:"âœ¨ ê²°ê³¼",
        rightSub:"ìƒìœ„ ì¶”ì²œ + ì´ìœ  + ì¦ê²¨ì°¾ê¸°/ë¹„êµ + AI ëŠë‚Œ ì´ë¯¸ì§€",
        btnFavOnly:"ì¦ê²¨ì°¾ê¸°ë§Œ",
        btnClearCompare:"ë¹„êµ ë¹„ìš°ê¸°",
        legalTitle:"ë©´ì±…/ê³ ì§€",
        legalText:"ê°€ê²©/ì¬ê³ /í˜œíƒì€ ë³€ë™ë  ìˆ˜ ìˆëŠ” ì°¸ê³  ì •ë³´ì…ë‹ˆë‹¤. ìµœì¢… íŒë‹¨ì€ íŒë§¤ì²˜/ì œì¡°ì‚¬ ì •ë³´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•˜ì„¸ìš”.",
        refFoot:"âœ”ï¸ ì„¤ëª… ë¬¸êµ¬ëŠ” ì§ì ‘ ìš”ì•½ì´ë©°, í‘œ/ì´ë¯¸ì§€ ìŠ¤í¬ë˜í•‘ì€ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br/>âœ”ï¸ ì œí’ˆëª…ì€ ì„¤ëª… ëª©ì ì˜ í‘œê¸°ì´ë©° ìƒí‘œëŠ” ê° ì†Œìœ ìì—ê²Œ ìˆìŠµë‹ˆë‹¤.",
        footerB:"íŒ",
        footerT:"ë¹„êµ(í‘œ)ë¥¼ ì—´ê³  ì‹¶ìœ¼ë©´ ì¹´ë“œì—ì„œ â€˜ë¹„êµâ€™ë¥¼ 2~3ê°œ ë‹´ì•„ì£¼ì„¸ìš”.",
        cmpTitle:"ë¹„êµ(ìµœëŒ€ 3ê°œ) Â· í‘œ í˜•íƒœ",
        close:"ë‹«ê¸°",
        openLinks:"ì„ íƒ í•­ëª© ì—´ê¸°",
        removeAll:"ì „ë¶€ ì œê±°",
        emptyResult:"ì¡°ê±´ì— ë§ëŠ” ê²°ê³¼ê°€ ì—†ì–´ìš”. ê²€ìƒ‰/í•„í„°ë¥¼ ì™„í™”í•´ë³´ì„¸ìš”.",
        emptyReset:"í•„í„° ì´ˆê¸°í™”",
        toast:{
          moved:(x)=>`${x} íƒ­`,
          ran:"ì¶”ì²œì„ ë§Œë“¤ì—ˆì–´ìš”!",
          sample:"ìƒ˜í”Œ ë‹µì•ˆì„ ì±„ì› ì–´ìš”",
          reset:"ì´ˆê¸°í™” ì™„ë£Œ",
          shared:"ê³µìœ  ë§í¬ë¥¼ í´ë¦½ë³´ë“œì— ë³µì‚¬í–ˆì–´ìš”",
          shareFail:"ë³µì‚¬ ì‹¤íŒ¨ â€” ì£¼ì†Œì°½ URLì„ ê·¸ëŒ€ë¡œ ê³µìœ í•´ë„ ë¼ìš”",
          favOnlyOn:"ì¦ê²¨ì°¾ê¸°ë§Œ ë³´ê¸° ON",
          favOnlyOff:"ì¦ê²¨ì°¾ê¸°ë§Œ ë³´ê¸° OFF",
          compareAdd:"ë¹„êµì— ì¶”ê°€",
          compareRemove:"ë¹„êµì—ì„œ ì œê±°",
          compareFull:"ë¹„êµëŠ” ìµœëŒ€ 3ê°œê¹Œì§€!",
          compareCleared:"ë¹„êµ ëª©ë¡ì„ ë¹„ì› ì–´ìš”",
          opened:"ì„ íƒ ë§í¬ë¥¼ ì—´ì—ˆì–´ìš”",
          regen:"AI ëŠë‚Œ ë³€í˜• ìƒì„±!"
        },
        labels:{ref:"ì°¸ê³ ê°€", fit:"ì í•©ë„", open:"ì—´ê¸°", favorite:"ì¦ê²¨ì°¾ê¸°", compare:"ë¹„êµ", price:"ê°€ê²©", why:"ì¶”ì²œ ì´ìœ :", ai:"AI ë³€í˜•", brand:"ì œì¡°ì‚¬"}
      },
      en:{
        uiTitle:"Chooser: Laptop Â· Phone Â· Robot Vacuum Â· Headphones Â· Keyboard",
        uiSubtitle:"A few questions â†’ scored picks + search/sort/favorites/compare Â· AI-style visuals generated locally",
        pillLocal:"Local-only Â· No server upload",
        pillPrice:"Prices are rough references Â· verify at retailer",
        leftTitle:"ğŸ§  Questions",
        leftSub:"Switch tabs to change questions, filters and products.",
        labSearch:"Search",
        labSort:"Sort",
        sort:{score_desc:"Highest score",price_asc:"Lowest price",price_desc:"Highest price",name_asc:"Name Aâ†’Z"},
        placeholderSearch:"e.g., battery, ANC, hot-swap, 2.4Gâ€¦",
        btnRun:"Generate",
        btnSample:"Fill sample",
        btnShare:"Share this state",
        btnReset:"Reset",
        note:"âœ… Everything runs in your browser.<br/>âœ¨ Product visuals are AI-style renders generated locally (no external files/servers).<br/>ğŸ§­ How to use: 1) Choose a tab â†’ 2) Answer questions â†’ 3) Click â€œGenerateâ€ (filters/search optional).<br/>âš ï¸ Prices are rough references; verify at the source site.",
        kCatLabel:"Category",
        kUpdatedLabel:"Updated",
        kFavLabel:"Favorites",
        rightTitle:"âœ¨ Results",
        rightSub:"Top picks + reasons + compare/favorites + AI-style visuals",
        btnFavOnly:"Favorites only",
        btnClearCompare:"Clear compare",
        legalTitle:"Disclaimer",
        legalText:"Prices/availability can change and are provided as reference information. Make final decisions based on retailer/manufacturer info.",
        refFoot:"âœ”ï¸ Copy-free summaries (no spec-table/image scraping).<br/>âœ”ï¸ Product names are descriptive; trademarks belong to owners.",
        footerB:"Tip",
        footerT:"To open the compare table, add 2â€“3 items via â€œCompareâ€.",
        cmpTitle:"Compare (up to 3) Â· Table view",
        close:"Close",
        openLinks:"Open selected links",
        removeAll:"Remove all",
        emptyResult:"No matches. Try loosening filters or search.",
        emptyReset:"Reset filters",
        toast:{
          moved:(x)=>`Tab: ${x}`,
          ran:"Generated!",
          sample:"Sample answers filled",
          reset:"Reset done",
          shared:"Share link copied",
          shareFail:"Copy failed â€” share the URL in the address bar",
          favOnlyOn:"Favorites-only ON",
          favOnlyOff:"Favorites-only OFF",
          compareAdd:"Added to compare",
          compareRemove:"Removed from compare",
          compareFull:"Compare supports up to 3 items",
          compareCleared:"Compare cleared",
          opened:"Opened selected links",
          regen:"AI-style variation generated!"
        },
        labels:{ref:"Reference", fit:"Fit", open:"Open", favorite:"Favorite", compare:"Compare", price:"Price", why:"Why:", ai:"AI Var", brand:"Manufacturer"}
      }
    };

    // ===========================
    // helpers / state
    // ===========================
    const $ = (id)=>document.getElementById(id);
    const LS_STATE="chooser_state_ultra_v1";
    const LS_LANG="chooser_lang_ultra_v1";
    const LS_FAV="chooser_fav_ultra_v1";
    const LS_IMGVAR="chooser_imgvar_ultra_v1";

    const clamp=(n,a,b)=>Math.max(a,Math.min(b,n));
    function showToast(msg){
      const t=$("toast");
      t.textContent=msg;
      t.style.display="block";
      clearTimeout(showToast._t);
      showToast._t=setTimeout(()=>t.style.display="none",2200);
    }
    function saveJSON(k,v){ localStorage.setItem(k, JSON.stringify(v)); }
    function loadJSON(k,fb){ try{ const r=localStorage.getItem(k); return r?JSON.parse(r):fb; }catch{ return fb; } }

    function money(lang, n){
      if(!Number.isFinite(n)) return "-";
      if(lang==="ko") return new Intl.NumberFormat("ko-KR").format(n)+"ì›";
      return "$"+new Intl.NumberFormat("en-US").format(Math.round(n/1300)); // rough KRW->USD
    }
    function resolveLink(it){
      const link = it && it.link ? String(it.link) : "";
      if(link.startsWith("https://search.danawa.com/")){
        return `https://www.google.com/search?q=${encodeURIComponent(`${it.brand||""} ${it.name}`.trim())}`;
      }
      if(link) return link;
      return `https://www.google.com/search?q=${encodeURIComponent(`${it.brand||""} ${it.name}`.trim())}`;
    }
    function getBrandMeta(brand){
      const key = brand || "Other";
      const meta = BRAND_META[key] || BRAND_META.Other;
      return meta || {order:999,color:"#7aa2ff",logo:"â—"};
    }

    function icon(cat){
      const m={
        laptop:`<svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M7 7.5h10a2 2 0 0 1 2 2v5.5H5V9.5a2 2 0 0 1 2-2Z" stroke="currentColor" opacity=".85" stroke-width="1.7"/><path d="M4 17h16" stroke="currentColor" opacity=".7" stroke-width="1.7" stroke-linecap="round"/></svg>`,
        phone:`<svg width="18" height="18" viewBox="0 0 24 24" fill="none"><rect x="7" y="3.5" width="10" height="17" rx="2.2" stroke="currentColor" opacity=".85" stroke-width="1.7"/><path d="M10 18.2h4" stroke="currentColor" opacity=".7" stroke-width="1.7" stroke-linecap="round"/></svg>`,
        robot:`<svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M7 13.5a5 5 0 0 1 10 0v1.2a2.8 2.8 0 0 1-2.8 2.8H9.8A2.8 2.8 0 0 1 7 14.7v-1.2Z" stroke="currentColor" opacity=".85" stroke-width="1.7"/><path d="M9 10.2V8.5m6 1.7V8.5" stroke="currentColor" opacity=".7" stroke-width="1.7" stroke-linecap="round"/><path d="M6.3 18.2h11.4" stroke="currentColor" opacity=".7" stroke-width="1.7" stroke-linecap="round"/></svg>`,
        headphones:`<svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M6 13v5a2 2 0 0 0 2 2h1v-7H8a2 2 0 0 0-2 2Z" stroke="currentColor" stroke-width="1.7" opacity=".8"/><path d="M18 13v5a2 2 0 0 1-2 2h-1v-7h1a2 2 0 0 1 2 2Z" stroke="currentColor" stroke-width="1.7" opacity=".8"/><path d="M6.5 13V11a5.5 5.5 0 0 1 11 0v2" stroke="currentColor" stroke-width="1.7" opacity=".6" stroke-linecap="round"/></svg>`,
        keyboard:`<svg width="18" height="18" viewBox="0 0 24 24" fill="none"><rect x="3.8" y="7" width="16.4" height="10" rx="2.2" stroke="currentColor" stroke-width="1.7" opacity=".85"/><path d="M6.2 10h.01M8.4 10h.01M10.6 10h.01M12.8 10h.01M15 10h.01M17.2 10h.01" stroke="currentColor" stroke-width="2.4" opacity=".55" stroke-linecap="round"/><path d="M6.2 12.7h.01M8.4 12.7h.01M10.6 12.7h.01M12.8 12.7h.01M15 12.7h.01M17.2 12.7h.01" stroke="currentColor" stroke-width="2.4" opacity=".55" stroke-linecap="round"/><path d="M8 15h8" stroke="currentColor" stroke-width="1.8" opacity=".6" stroke-linecap="round"/></svg>`
      };
      return m[cat]||"";
    }

    // ===========================
    // Deterministic hash + PRNG
    // ===========================
    function hashStr(s){
      let h=2166136261;
      for(let i=0;i<s.length;i++){ h^=s.charCodeAt(i); h = Math.imul(h, 16777619); }
      return (h>>>0);
    }
    function makePRNG(seed){
      let t = seed >>> 0;
      return function(){
        // xorshift32
        t ^= t << 13; t >>>= 0;
        t ^= t >> 17; t >>>= 0;
        t ^= t << 5;  t >>>= 0;
        return (t >>> 0) / 4294967296;
      };
    }

    // ===========================
    // AI-style image renderer (Canvas -> WebP dataURL)
    // - goal: "diffusion-ish render" vibe without real AI
    // - consistent, premium, logo-free, local-only
    // ===========================
    const imgVar = loadJSON(LS_IMGVAR, {}); // per itemKey => integer variation
    const imgCache = new Map(); // key => dataURL (memory cache)
    const BRAND_META = {
      Apple:{order:1,color:"#c6d0ff",url:"https://www.apple.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M16.6 13.5c0 2.6 2.2 3.5 2.2 3.6-.5 1.5-1.7 3.3-3.4 3.3-1.3 0-1.8-.8-3.4-.8-1.5 0-2 .8-3.3.8-1.6 0-3-1.6-3.7-3.2-1.9-4.1.5-6.2 1.3-7 .8-.8 2-1.2 3.1-1.2 1.2 0 2.2.8 3.4.8 1.2 0 1.9-.8 3.4-.8.6 0 2.3.1 3.4 1.7-.1.1-2 1.2-2 3.8Z"/><path fill="currentColor" d="M14.8 6.1c.6-.7 1-1.7.9-2.7-1 .1-2 .7-2.6 1.4-.6.7-1 1.7-.9 2.6 1 .1 2-.5 2.6-1.3Z"/></svg>`},
      Samsung:{order:2,color:"#9bd0ff",url:"https://www.samsung.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><ellipse cx="12" cy="12" rx="10" ry="6" fill="none" stroke="currentColor" stroke-width="2"/><path d="M7 12h10" stroke="currentColor" stroke-width="2"/></svg>`},
      Google:{order:3,color:"#a7f3d0",url:"https://store.google.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 5.3c1.6 0 3 .6 4.1 1.6l2.8-2.8C17.2 2.5 14.8 1.5 12 1.5 7.5 1.5 3.6 4 1.7 7.7l3.3 2.6C6.1 7.2 8.8 5.3 12 5.3Z"/><path fill="currentColor" d="M22 12.2c0-.7-.1-1.3-.2-1.9H12v3.8h5.6c-.3 1.4-1.1 2.6-2.4 3.4l3 2.4c1.8-1.6 2.8-4 2.8-7.7Z"/><path fill="currentColor" d="M5 14.3c-.3-.9-.4-1.9-.4-2.9s.1-2 .4-2.9L1.7 5.9C.6 8 .1 10 .1 12.1s.5 4.1 1.6 6.2L5 14.3Z"/><path fill="currentColor" d="M12 22.7c2.7 0 5-1 6.7-2.6l-3-2.4c-.9.6-2.1 1-3.7 1-3.2 0-5.9-1.9-7-4.7l-3.3 2.6C3.6 20.2 7.5 22.7 12 22.7Z"/></svg>`},
      LG:{order:4,color:"#ff9aa8",url:"https://www.lg.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2"/><circle cx="9" cy="10" r="1.5" fill="currentColor"/><path d="M8 16c2 2 6 2 8 0" stroke="currentColor" stroke-width="2" fill="none"/></svg>`},
      Lenovo:{order:5,color:"#ffb86b",url:"https://www.lenovo.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><rect x="3" y="6" width="18" height="12" rx="3" fill="none" stroke="currentColor" stroke-width="2"/><path d="M8 9v6h6" stroke="currentColor" stroke-width="2" fill="none"/></svg>`},
      ASUS:{order:6,color:"#bba3ff",url:"https://www.asus.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 16h18l-3-6H6l-3 6Z" fill="none" stroke="currentColor" stroke-width="2"/><path d="M9 10l3-4 3 4" stroke="currentColor" stroke-width="2" fill="none"/></svg>`},
      Dell:{order:7,color:"#8bd0ff",url:"https://www.dell.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2"/><path d="M8 8h5a4 4 0 0 1 0 8H8V8Z" stroke="currentColor" stroke-width="2" fill="none"/></svg>`},
      Microsoft:{order:8,color:"#9fe0c3",url:"https://www.microsoft.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><rect x="3" y="3" width="8" height="8" fill="currentColor"/><rect x="13" y="3" width="8" height="8" fill="currentColor"/><rect x="3" y="13" width="8" height="8" fill="currentColor"/><rect x="13" y="13" width="8" height="8" fill="currentColor"/></svg>`},
      Sony:{order:9,color:"#cbd5ff",url:"https://www.sony.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><path d="M4 9h10a4 4 0 1 1 0 8H4" stroke="currentColor" stroke-width="2" fill="none"/></svg>`},
      Bose:{order:10,color:"#f6ad55",url:"https://www.bose.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><rect x="4" y="7" width="16" height="10" rx="2" fill="none" stroke="currentColor" stroke-width="2"/><path d="M7 9v6M12 9v6M17 9v6" stroke="currentColor" stroke-width="2"/></svg>`},
      Logitech:{order:11,color:"#8dd0ff",url:"https://www.logitech.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><circle cx="9" cy="12" r="4" fill="none" stroke="currentColor" stroke-width="2"/><path d="M13 12h4" stroke="currentColor" stroke-width="2"/><circle cx="18" cy="12" r="2" fill="currentColor"/></svg>`},
      Keychron:{order:12,color:"#b6f1d2",url:"https://www.keychron.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><path d="M5 6v12M19 6l-8 8 8 4" stroke="currentColor" stroke-width="2" fill="none"/></svg>`},
      Acer:{order:13,color:"#b7f7a5",url:"https://www.acer.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><path d="M4 18L12 4l8 14" fill="none" stroke="currentColor" stroke-width="2"/><path d="M7 14h10" stroke="currentColor" stroke-width="2"/></svg>`},
      Razer:{order:14,color:"#b6ff6b",url:"https://www.razer.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><circle cx="8" cy="12" r="3" stroke="currentColor" stroke-width="2" fill="none"/><circle cx="16" cy="12" r="3" stroke="currentColor" stroke-width="2" fill="none"/><path d="M10 12h4" stroke="currentColor" stroke-width="2"/></svg>`},
      Xiaomi:{order:15,color:"#ffb86b",url:"https://www.mi.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><rect x="5" y="5" width="14" height="14" rx="3" fill="none" stroke="currentColor" stroke-width="2"/><path d="M8 16V8h2v6m2-6h2a2 2 0 0 1 0 4h-2" stroke="currentColor" stroke-width="2" fill="none"/></svg>`},
      Roborock:{order:16,color:"#9bd0ff",url:"https://global.roborock.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2"/><path d="M8 14h8" stroke="currentColor" stroke-width="2"/><circle cx="10" cy="11" r="1.2" fill="currentColor"/><circle cx="14" cy="11" r="1.2" fill="currentColor"/></svg>`},
      Ecovacs:{order:17,color:"#a7f3d0",url:"https://www.ecovacs.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 6h12v12H6z" fill="none" stroke="currentColor" stroke-width="2"/><path d="M8 12h8" stroke="currentColor" stroke-width="2"/></svg>`},
      Dreame:{order:18,color:"#b0c4ff",url:"https://www.dreametech.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 6h6a6 6 0 1 1 0 12H6z" fill="none" stroke="currentColor" stroke-width="2"/><path d="M8 9h4" stroke="currentColor" stroke-width="2"/></svg>`},
      Anker:{order:19,color:"#ffd39b",url:"https://www.anker.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2"/><path d="M9 15l3-6 3 6" stroke="currentColor" stroke-width="2" fill="none"/></svg>`},
      Sennheiser:{order:20,color:"#9db4ff",url:"https://www.sennheiser.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><path d="M7 16h7a3 3 0 1 0 0-6H10a3 3 0 1 1 0-6h7" stroke="currentColor" stroke-width="2" fill="none"/></svg>`},
      Leopold:{order:21,color:"#c2f0d6",url:"https://www.leopold.co.kr",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 7h12v10H6z" fill="none" stroke="currentColor" stroke-width="2"/><path d="M9 10h6M9 13h6" stroke="currentColor" stroke-width="2"/></svg>`},
      Other:{order:99,color:"#7aa2ff",url:"https://www.google.com",svg:`<svg class="brandLogo" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2"/><path d="M8 12h8" stroke="currentColor" stroke-width="2"/></svg>`}
    };

    function roundRect(ctx,x,y,w,h,r){
      const rr = Math.min(r, w/2, h/2);
      ctx.beginPath();
      ctx.moveTo(x+rr, y);
      ctx.arcTo(x+w, y, x+w, y+h, rr);
      ctx.arcTo(x+w, y+h, x, y+h, rr);
      ctx.arcTo(x, y+h, x, y, rr);
      ctx.arcTo(x, y, x+w, y, rr);
      ctx.closePath();
    }

    function addFilmGrain(ctx, w, h, rnd){
      // subtle grain + dither for "render" feel
      const id = ctx.getImageData(0,0,w,h);
      const d = id.data;
      const strength = 10; // 0..255 very low
      for(let i=0;i<d.length;i+=4){
        const n = (rnd()*2-1)*strength;
        d[i]   = clamp(d[i]   + n, 0, 255);
        d[i+1] = clamp(d[i+1] + n, 0, 255);
        d[i+2] = clamp(d[i+2] + n, 0, 255);
      }
      ctx.putImageData(id,0,0);
    }

    function vignette(ctx, w, h){
      const g = ctx.createRadialGradient(w*0.5, h*0.45, 80, w*0.5, h*0.45, Math.max(w,h)*0.72);
      g.addColorStop(0,"rgba(0,0,0,0)");
      g.addColorStop(1,"rgba(0,0,0,0.14)");
      ctx.fillStyle = g;
      ctx.fillRect(0,0,w,h);
    }

    function softBloom(ctx, w, h){
      // cheap bloom: draw a blurred copy (works well enough)
      const tmp = document.createElement("canvas");
      tmp.width=w; tmp.height=h;
      const tctx = tmp.getContext("2d");
      tctx.drawImage(ctx.canvas, 0, 0);
      ctx.save();
      ctx.globalAlpha = 0.35;
      ctx.filter = "blur(10px)";
      ctx.drawImage(tmp, 0, 0);
      ctx.filter = "none";
      ctx.globalAlpha = 1;
      ctx.restore();
    }

    function genAppleStyleDataURL(cat, id, name, variation=0){
      const key = `${cat}:${id}:${variation}`;
      if(imgCache.has(key)) return imgCache.get(key);

      const seed = hashStr(`${cat}|${id}|${name}|v${variation}`);
      const rnd = makePRNG(seed);

      const c = document.createElement("canvas");
      c.width = 920;
      c.height = 640;
      const ctx = c.getContext("2d");

      const angle = rnd()*20 - 10;
      const lightX = rnd()*800;
      const hueShift = rnd()*40;

      ctx.translate(c.width*0.5, c.height*0.5);
      ctx.rotate(angle * Math.PI/180);

      // background gradient variation
      const bg = ctx.createLinearGradient(0,0,c.width,c.height);
      bg.addColorStop(0, `hsl(${200+hueShift},30%,95%)`);
      bg.addColorStop(1, `hsl(${220+hueShift},35%,88%)`);
      ctx.fillStyle = bg;
      ctx.fillRect(-400,-300,800,600);

      ctx.setTransform(1,0,0,1,0,0);
      const aura = ctx.createRadialGradient(lightX, 120, 40, lightX, 120, 420);
      aura.addColorStop(0, "rgba(255,255,255,0.35)");
      aura.addColorStop(1, "rgba(255,255,255,0)");
      ctx.fillStyle = aura;
      ctx.fillRect(0,0,c.width,c.height);

      // stage shadow
      ctx.fillStyle = "rgba(0,0,0,0.14)";
      ctx.beginPath();
      ctx.ellipse(c.width*0.52, c.height*0.73, 280, 58, 0, 0, Math.PI*2);
      ctx.fill();

      // product material palette
      const metalL = 55 + rnd()*18;     // lightness
      const metalS = 8 + rnd()*10;      // saturation
      const hue = rnd()*360;
      const metalH = (hue + 210 + rnd()*40) % 360;

      const body = `hsl(${metalH}, ${metalS}%, ${metalL}%)`;
      const body2 = `hsl(${metalH}, ${metalS+2}%, ${metalL-6}%)`;
      const dark = `hsl(${(metalH+210)%360}, 14%, ${18 + rnd()*8}%)`;

      // draw product centered with slight tilt
      ctx.save();
      ctx.translate(c.width*0.52, c.height*0.56);
      ctx.rotate((rnd()*8-4) * Math.PI/180);

      // helper: metallic fill
      function fillMetalShape(x,y,w,h,r){
        const mg = ctx.createLinearGradient(x,y, x+w, y+h);
        mg.addColorStop(0, "rgba(255,255,255,0.50)");
        mg.addColorStop(0.18, body);
        mg.addColorStop(0.62, body2);
        mg.addColorStop(1, "rgba(0,0,0,0.18)");
        ctx.fillStyle = mg;
        roundRect(ctx, x,y,w,h,r); ctx.fill();
      }

      // product-specific shapes
      if(cat==="laptop"){
        // lid
        ctx.shadowColor="rgba(0,0,0,.18)";
        ctx.shadowBlur=28; ctx.shadowOffsetY=16;
        fillMetalShape(-210, -170, 420, 265, 22);
        ctx.shadowBlur=0; ctx.shadowOffsetY=0;

        // screen glass
        const sg = ctx.createLinearGradient(-190,-150, 190, 60);
        sg.addColorStop(0,"rgba(0,0,0,.62)");
        sg.addColorStop(1,"rgba(0,0,0,.22)");
        ctx.fillStyle=sg;
        roundRect(ctx, -192, -152, 384, 216, 18); ctx.fill();

        // screen highlight
        const hl = ctx.createLinearGradient(-190,-150, 120, 40);
        hl.addColorStop(0,"rgba(255,255,255,.22)");
        hl.addColorStop(0.35,"rgba(255,255,255,0)");
        ctx.fillStyle=hl;
        roundRect(ctx, -192, -152, 384, 216, 18); ctx.fill();

        // base
        fillMetalShape(-240, 92, 480, 44, 16);

        // keyboard hint
        ctx.fillStyle="rgba(0,0,0,.10)";
        roundRect(ctx, -170, 104, 340, 20, 10); ctx.fill();
      }
      else if(cat==="phone"){
        ctx.shadowColor="rgba(0,0,0,.18)";
        ctx.shadowBlur=26; ctx.shadowOffsetY=16;
        fillMetalShape(-88, -190, 176, 370, 42);
        ctx.shadowBlur=0; ctx.shadowOffsetY=0;

        // screen
        const s=ctx.createLinearGradient(-60,-160, 76, 140);
        s.addColorStop(0,"rgba(0,0,0,.66)");
        s.addColorStop(1,"rgba(0,0,0,.22)");
        ctx.fillStyle=s;
        roundRect(ctx, -70, -172, 140, 310, 34); ctx.fill();

        // notch hint
        ctx.fillStyle="rgba(255,255,255,.10)";
        roundRect(ctx, -26, -168, 52, 10, 6); ctx.fill();

        // subtle edge stroke
        ctx.strokeStyle="rgba(255,255,255,.28)";
        ctx.lineWidth=2;
        roundRect(ctx, -88, -190, 176, 370, 42); ctx.stroke();
      }
      else if(cat==="robot"){
        ctx.shadowColor="rgba(0,0,0,.18)";
        ctx.shadowBlur=28; ctx.shadowOffsetY=16;

        const rg = ctx.createRadialGradient(-40,-55, 30, 0,0, 190);
        rg.addColorStop(0,"rgba(255,255,255,.55)");
        rg.addColorStop(0.45, body);
        rg.addColorStop(1,"rgba(0,0,0,.16)");
        ctx.fillStyle = rg;
        ctx.beginPath(); ctx.arc(0,0,150,0,Math.PI*2); ctx.fill();

        ctx.shadowBlur=0; ctx.shadowOffsetY=0;

        // inner ring
        ctx.strokeStyle="rgba(0,0,0,.12)";
        ctx.lineWidth=18;
        ctx.beginPath(); ctx.arc(0,-10,74,0,Math.PI*2); ctx.stroke();

        // sensor dot
        ctx.fillStyle="rgba(0,0,0,.16)";
        ctx.beginPath(); ctx.arc(0,-10,12,0,Math.PI*2); ctx.fill();

        // glossy highlight
        const gloss = ctx.createRadialGradient(-50,-85, 20, 0,0, 200);
        gloss.addColorStop(0,"rgba(255,255,255,.38)");
        gloss.addColorStop(1,"rgba(255,255,255,0)");
        ctx.fillStyle = gloss;
        ctx.beginPath(); ctx.arc(0,0,150,0,Math.PI*2); ctx.fill();
      }
      else if(cat==="headphones"){
        ctx.shadowColor="rgba(0,0,0,.20)";
        ctx.shadowBlur=30; ctx.shadowOffsetY=18;

        // headband
        ctx.strokeStyle=dark;
        ctx.lineWidth=28;
        ctx.lineCap="round";
        ctx.beginPath();
        ctx.arc(0,-52,170,Math.PI*0.10,Math.PI*0.90,true);
        ctx.stroke();

        // cups
        ctx.fillStyle=dark;
        roundRect(ctx, -190, 10, 98, 142, 40); ctx.fill();
        roundRect(ctx, 92, 10, 98, 142, 40); ctx.fill();

        ctx.shadowBlur=0; ctx.shadowOffsetY=0;

        // cup gloss
        const gg=ctx.createLinearGradient(-176,18, -118,150);
        gg.addColorStop(0,"rgba(255,255,255,.22)");
        gg.addColorStop(1,"rgba(255,255,255,0)");
        ctx.fillStyle=gg;
        roundRect(ctx, -176, 18, 62, 126, 30); ctx.fill();
        roundRect(ctx, 112, 18, 62, 126, 30); ctx.fill();
      }
      else if(cat==="keyboard"){
        ctx.shadowColor="rgba(0,0,0,.18)";
        ctx.shadowBlur=28; ctx.shadowOffsetY=16;

        fillMetalShape(-240, -72, 480, 150, 26);
        ctx.shadowBlur=0; ctx.shadowOffsetY=0;

        // keybed
        ctx.fillStyle="rgba(0,0,0,.08)";
        roundRect(ctx, -220, -52, 440, 112, 18); ctx.fill();

        // keys (slightly varied)
        const cols=14, rows=4, gap=9;
        const padX=24, padY=18;
        const kw=(480-2*padX-(cols-1)*gap)/cols;
        const kh=18;

        for(let r=0;r<rows;r++){
          for(let c2=0;c2<cols;c2++){
            const x=-240+padX+c2*(kw+gap);
            const y=-72+padY+r*(kh+11);
            const kgl = 0.18 + rnd()*0.12;
            ctx.fillStyle=`rgba(255,255,255,${kgl})`;
            roundRect(ctx, x, y, kw, kh, 6); ctx.fill();
          }
        }
        // spacebar
        ctx.fillStyle="rgba(255,255,255,.20)";
        roundRect(ctx, -82, 54, 164, 18, 7); ctx.fill();
      }
      else{
        // generic slab
        ctx.shadowColor="rgba(0,0,0,.18)";
        ctx.shadowBlur=28; ctx.shadowOffsetY=16;
        fillMetalShape(-200,-120,400,240,28);
        ctx.shadowBlur=0; ctx.shadowOffsetY=0;
      }

      ctx.restore();

      // post effects
      softBloom(ctx, c.width, c.height);
      vignette(ctx, c.width, c.height);
      addFilmGrain(ctx, c.width, c.height, rnd);

      const url = c.toDataURL("image/webp", 0.92);
      imgCache.set(key, url);
      return url;
    }

    function bumpVariation(itemKeyStr){
      imgVar[itemKeyStr] = (imgVar[itemKeyStr]||0) + 1;
      saveJSON(LS_IMGVAR, imgVar);
      // clear memory cache for that item variations range isn't necessary; just allow new key
    }

    // ===========================
    // Lightbox
    // ===========================
    function openLightbox(title, src, cap){
      $("lbTitle").textContent = title;
      $("lbImg").src = src;
      $("lbCap").textContent = cap || "";
      $("lightbox").classList.add("open");
      $("lightbox").setAttribute("aria-hidden","false");
    }
    function closeLightbox(){
      $("lightbox").classList.remove("open");
      $("lightbox").setAttribute("aria-hidden","true");
      $("lbImg").src = "";
    }

    // ===========================
    // Data model
    // ===========================
    function item(cat,id,name,price,features,vec,desc,attrs,link,brand){
      return {cat,id,name,price,features,vec,desc,attrs,link,brand};
    }

    // NOTE: Prices are "rough references" (no live scraping).
    const DATA = {
      laptop:{
        label:{ko:"ë…¸íŠ¸ë¶",en:"Laptop"}, updated:"2026-02-18",
        features:[
          {id:"value",ko:"ê°€ì„±ë¹„",en:"Value"},
          {id:"battery",ko:"ë°°í„°ë¦¬",en:"Battery"},
          {id:"screen",ko:"í™”ë©´",en:"Display"},
          {id:"portable",ko:"íœ´ëŒ€ì„±",en:"Portability"},
          {id:"gaming",ko:"ê²Œì„/ê·¸ë˜í”½",en:"Gaming/Graphics"}
        ],
        questions:[
          {id:"use", label:{ko:"ì£¼ìš” ì‚¬ìš©",en:"Use"}, sub:{ko:"ìš©ë„ì— ë”°ë¼ ì •ë‹µì´ ê°ˆë ¤ìš”.",en:"Use case changes the best pick."},
            options:[
              {v:"office",t:{ko:"ë¬¸ì„œ/ì›¹",en:"Office/Web"},w:{battery:3,portable:2,screen:1,value:1}},
              {v:"dev",t:{ko:"ê°œë°œ/ë©€í‹°",en:"Dev/Multitask"},w:{perf:3,screen:2,battery:1}},
              {v:"creator",t:{ko:"ì˜ìƒ/ë””ìì¸",en:"Creator"},w:{screen:3,perf:3,color:2}},
              {v:"game",t:{ko:"ê²Œì„/3D",en:"Gaming/3D"},w:{gpu:3,perf:2,screen:2}}
            ]},
          {id:"mobility", label:{ko:"íœ´ëŒ€ì„±",en:"Portability"}, sub:{ko:"ë§¤ì¼ ë“¤ë©´ ë¬´ê²Œ ì²´ê°ì´ ì»¤ìš”.",en:"Daily carry makes weight matter."},
            options:[
              {v:"ultra",t:{ko:"ìµœëŒ€í•œ ê°€ë³ê²Œ",en:"Ultra-light"},w:{portable:3,battery:1}},
              {v:"balanced",t:{ko:"ê· í˜•",en:"Balanced"},w:{portable:2,screen:1}},
              {v:"desk",t:{ko:"ê±°ì¹˜ ìœ„ì£¼",en:"Mostly desk"},w:{screen:2,perf:2}}
            ]},
          {id:"os", label:{ko:"OS ì„ í˜¸",en:"OS"}, sub:{ko:"ì›Œí¬í”Œë¡œìš°/ì•± í˜¸í™˜ì´ ê°ˆë¦½ë‹ˆë‹¤.",en:"Workflow compatibility differs."},
            options:[
              {v:"mac",t:{ko:"macOS",en:"macOS"},w:{mac:3}},
              {v:"win",t:{ko:"Windows",en:"Windows"},w:{win:3}},
              {v:"any",t:{ko:"ìƒê´€ì—†ìŒ",en:"Either"},w:{mac:1,win:1}}
            ]}
        ],
        items:[
          item("laptop","mba13","MacBook Air 13 (M-series)",1590000,["battery","portable"],{mac:3,battery:3,portable:3,screen:2,perf:2,value:1},{ko:"íœ´ëŒ€+ë°°í„°ë¦¬ ë°¸ëŸ°ìŠ¤ ê°•í•¨. ì¼ìƒ/ê°œë°œì— ë¬´ë‚œ.",en:"Great portability + battery. Solid for daily/dev."},{"Display":"13\"","Weight":"~1.2kg","OS":"macOS","Battery":"Long","Best":"Daily/Dev"},"https://www.apple.com/kr/macbook-air/","Apple"),
          item("laptop","mba15","MacBook Air 15 (M-series)",1890000,["battery","screen"],{mac:3,battery:3,portable:2,screen:3,perf:2},{ko:"ëŒ€í™”ë©´+ë°°í„°ë¦¬ë¡œ ë©€í‹°íƒœìŠ¤í‚¹ ë§Œì¡±.",en:"Large display + long battery for multitasking."},{"Display":"15\"","Weight":"~1.5kg","OS":"macOS","Battery":"Long","Best":"Multitask"},"https://www.apple.com/kr/macbook-air/","Apple"),
          item("laptop","gram","LG gram (lightweight)",1650000,["portable","battery"],{win:3,portable:3,battery:2,screen:2,perf:2,value:2},{ko:"ì´ˆê²½ëŸ‰ ì»¨ì…‰ì˜ ì´ë™í˜•. â€˜ë§¤ì¼ ë“¤ê³  ë‹¤ë‹˜â€™ì— ê°•í•¨.",en:"Ultra-light travel friendly."},{"Display":"14~16\"","Weight":"Light","OS":"Windows","Battery":"Good","Best":"Travel/School"},"https://www.lge.co.kr/","LG"),
          item("laptop","ideapad","Lenovo IdeaPad (value)",990000,["value"],{win:3,value:3,battery:2,portable:2,screen:1,perf:1},{ko:"ì˜ˆì‚° ì œí•œì— ê°•í•œ ì‹¤ì†í˜•.",en:"Budget-friendly value pick."},{"Display":"Varies","Weight":"Mid","OS":"Windows","Battery":"OK","Best":"Budget"},"https://www.lenovo.com/kr/ko/","Lenovo"),
          item("laptop","zenbook","ASUS Zenbook OLED",1850000,["screen","portable"],{win:3,screen:3,portable:2,battery:2,perf:2,color:2},{ko:"OLED í™”ë©´ ë§Œì¡±ë„ ì²´ê°. ì‹œê° ì‘ì—…/ê°ìƒì— ìœ ë¦¬.",en:"OLED display feels great."},{"Display":"OLED","Weight":"Light","OS":"Windows","Battery":"Good","Best":"Display"},"https://www.asus.com/kr/","ASUS"),
          item("laptop","xps","Dell XPS (premium)",2600000,["screen"],{win:3,screen:3,perf:3,battery:2,portable:2},{ko:"í”„ë¦¬ë¯¸ì—„ ë¹Œë“œ/í™”ë©´ ì§€í–¥. â€˜ê³ ê¸‰ìŠ¤ëŸ¬ì›€â€™ ì²´ê°.",en:"Premium build and display focus."},{"Display":"High-end","Weight":"Mid","OS":"Windows","Battery":"Good","Best":"Premium Work"},"https://www.dell.com/ko-kr","Dell"),
          item("laptop","thinkpad","ThinkPad (business)",2300000,["screen"],{win:3,perf:2,screen:2,battery:2},{ko:"ì—…ë¬´/íƒ€ì´í•‘ ì•ˆì •ì„±. í‚¤ê° ì„ í˜¸ì¸µì— ì¸ê¸°.",en:"Work/typing reliability."},{"Display":"14\"","Weight":"Mid","OS":"Windows","Battery":"Good","Best":"Typing"},"https://www.lenovo.com/kr/ko/","Lenovo"),
          item("laptop","surface","Surface Laptop class",2100000,["portable","screen"],{win:3,portable:3,screen:2,battery:2,perf:2},{ko:"íœ´ëŒ€í˜• í”„ë¦¬ë¯¸ì—„ ê°ì„±. ë¬´ë‚œí•˜ê²Œ ì˜ˆì¨.",en:"Portable premium vibe."},{"Display":"13~15\"","Weight":"Light","OS":"Windows","Battery":"Good","Best":"Portable Work"},"https://www.microsoft.com/","Microsoft"),
          item("laptop","gaming","Gaming Laptop (RTX class)",1790000,["gaming","screen"],{win:3,gpu:3,perf:3,screen:3,battery:1,portable:1},{ko:"ê²Œì„/3D ì„±ëŠ¥ ìš°ì„ . ëŒ€ì‹  ë¬´ê²Œ/ë°°í„°ë¦¬ íƒ€í˜‘.",en:"Performance-first for gaming/3D."},{"Display":"High refresh","Weight":"Heavy","OS":"Windows","Battery":"Shorter","Best":"Gaming"},"https://rog.asus.com/","ASUS")
        ]
      },

      phone:{
        label:{ko:"í•¸ë“œí°",en:"Phone"}, updated:"2026-02-18",
        features:[
          {id:"value",ko:"ê°€ì„±ë¹„",en:"Value"},
          {id:"battery",ko:"ë°°í„°ë¦¬",en:"Battery"},
          {id:"camera",ko:"ì¹´ë©”ë¼",en:"Camera"},
          {id:"eco",ko:"ìƒíƒœê³„",en:"Ecosystem"},
          {id:"compact",ko:"ì½¤íŒ©íŠ¸",en:"Compact"}
        ],
        questions:[
          {id:"priority", label:{ko:"1ìˆœìœ„",en:"Top priority"}, sub:{ko:"í•˜ë‚˜ë§Œ ê³¨ë¼ë„ ì •í™•ë„â†‘",en:"Pick one to boost accuracy."},
            options:[
              {v:"camera",t:{ko:"ì¹´ë©”ë¼",en:"Camera"},w:{camera:3}},
              {v:"battery",t:{ko:"ë°°í„°ë¦¬",en:"Battery"},w:{battery:3}},
              {v:"perf",t:{ko:"ì†ë„/ê²Œì„",en:"Performance"},w:{perf:3}},
              {v:"eco",t:{ko:"ìƒíƒœê³„",en:"Ecosystem"},w:{eco:3}}
            ]},
          {id:"os", label:{ko:"OS",en:"OS"}, sub:{ko:"ì„ í˜¸ ìƒíƒœê³„ ì¤‘ì‹¬",en:"Choose ecosystem."},
            options:[
              {v:"ios",t:{ko:"iOS",en:"iOS"},w:{ios:3,eco:2}},
              {v:"android",t:{ko:"Android",en:"Android"},w:{and:3,eco:2}},
              {v:"any",t:{ko:"ìƒê´€ì—†ìŒ",en:"Either"},w:{ios:1,and:1}}
            ]},
          {id:"size", label:{ko:"í¬ê¸°",en:"Size"}, sub:{ko:"ì‘ìœ¼ë©´ íœ´ëŒ€â†‘, í¬ë©´ ì‹œì²­â†‘",en:"Compact vs big media."},
            options:[
              {v:"small",t:{ko:"ì‘ê²Œ",en:"Compact"},w:{compact:3}},
              {v:"big",t:{ko:"í¬ê²Œ",en:"Large"},w:{screen:3,battery:1}},
              {v:"any",t:{ko:"ìƒê´€ì—†ìŒ",en:"Any"},w:{screen:1}}
            ]}
        ],
        items:[
          item("phone","ip_base","iPhone (base class)",1290000,["camera","eco"],{ios:3,eco:3,camera:2,battery:2,perf:2},{ko:"ì¼ìƒ ë°¸ëŸ°ìŠ¤+ìƒíƒœê³„. â€˜ë¬´ë‚œí•˜ê²Œ ì˜í•¨â€™",en:"Balanced daily + ecosystem."},{"OS":"iOS","Camera":"Strong daily","Battery":"Good","Size":"Balanced","Best":"Ecosystem"},"https://www.apple.com/kr/iphone/","Apple"),
          item("phone","ip_pro","iPhone (Pro class)",1550000,["camera","eco"],{ios:3,eco:3,camera:3,perf:3,battery:2},{ko:"ì¹´ë©”ë¼/ì„±ëŠ¥ ìƒê¸‰. ì´¬ì˜ ë¹„ì¤‘ ë†’ìœ¼ë©´ ìœ ë¦¬.",en:"Top camera/performance class."},{"OS":"iOS","Camera":"Flagship","Battery":"Good","Size":"Mid","Best":"Camera"},"https://www.apple.com/kr/iphone/","Apple"),
          item("phone","galaxyS","Galaxy S (flagship)",1150000,["eco","camera"],{and:3,eco:3,camera:2,battery:2,perf:2},{ko:"ì•ˆë“œë¡œì´ë“œ í¸ì˜/ì—°ë™. ì „ì²´ ë°¸ëŸ°ìŠ¤ ì¢‹ìŒ.",en:"Android flexibility + integration."},{"OS":"Android","Camera":"Balanced","Battery":"Good","Size":"Balanced","Best":"Android"},"https://www.samsung.com/sec/","Samsung"),
          item("phone","ultra","Galaxy Ultra (camera)",1690000,["camera","battery"],{and:3,camera:3,battery:3,perf:2,eco:3},{ko:"ì¹´ë©”ë¼+ë°°í„°ë¦¬ ê°•ë ¥(ëŒ€í™”ë©´).",en:"Strong camera + battery (big)."},{"OS":"Android","Camera":"Top-tier","Battery":"Strong","Size":"Large","Best":"Camera+Battery"},"https://www.samsung.com/sec/","Samsung"),
          item("phone","pixel","Pixel class",990000,["camera"],{and:3,camera:3,battery:2,perf:2},{ko:"ì—°ì‚°ì‚¬ì§„ ìŠ¤íƒ€ì¼ ê°•ì . ì‚¬ì§„í†¤ ì„ í˜¸í•˜ë©´.",en:"Computational photo strength."},{"OS":"Android","Camera":"Computational","Battery":"OK","Size":"Balanced","Best":"Photos"},"https://store.google.com/","Google"),
          item("phone","value_mid","Value midrange Android",690000,["value","battery"],{and:3,value:3,battery:3,camera:2},{ko:"ê°€ì„±ë¹„+ë°°í„°ë¦¬ ì²´ê°. ì‹¤ì†í˜•.",en:"Strong value + battery."},{"OS":"Android","Camera":"Good enough","Battery":"Strong","Size":"Balanced","Best":"Value"},"https://www.mi.com/","Xiaomi")
        ]
      },

      robot:{
        label:{ko:"ë¡œë´‡ì²­ì†Œê¸°",en:"Robot vacuum"}, updated:"2026-02-18",
        features:[
          {id:"value",ko:"ê°€ì„±ë¹„",en:"Value"},
          {id:"dock",ko:"ë„í¬",en:"Dock"},
          {id:"mop",ko:"ë¬¼ê±¸ë ˆ",en:"Mopping"},
          {id:"avoid",ko:"íšŒí”¼",en:"Avoidance"},
          {id:"pet",ko:"í„¸/ì—‰í‚´",en:"Pets/Hair"}
        ],
        questions:[
          {id:"priority", label:{ko:"ìš°ì„ ìˆœìœ„",en:"Priority"}, sub:{ko:"ì²´ê°ì€ ê´€ë¦¬ í¸ì˜ì—ì„œ í¬ê²Œ ì˜µë‹ˆë‹¤.",en:"Hassle reduction matters most."},
            options:[
              {v:"dock",t:{ko:"ë„í¬(ìë™ê´€ë¦¬)",en:"Dock"},w:{dock:3}},
              {v:"mop",t:{ko:"ë¬¼ê±¸ë ˆ",en:"Mopping"},w:{mop:3}},
              {v:"avoid",t:{ko:"íšŒí”¼",en:"Avoidance"},w:{avoid:3}},
              {v:"value",t:{ko:"ê°€ì„±ë¹„",en:"Value"},w:{value:3}}
            ]},
          {id:"pets", label:{ko:"í„¸/ë¨¸ë¦¬ì¹´ë½",en:"Pets/Hair"}, sub:{ko:"í„¸ì´ ë§ìœ¼ë©´ ì—‰í‚´ ì²´ê°ì´ ì»¤ìš”.",en:"Hair makes tangles important."},
            options:[
              {v:"yes",t:{ko:"ë§ìŒ",en:"Yes"},w:{pet:3,avoid:1}},
              {v:"no",t:{ko:"ì ìŒ",en:"No"},w:{pet:1}}
            ]}
        ],
        items:[
          item("robot","premiumDock","Premium dock+mop class",1550000,["dock","mop","avoid","pet"],{dock:3,mop:3,avoid:3,pet:2},{ko:"ë¹„ì›€+ë¬¼ê±¸ë ˆ ìë™í™” ì²´ê°ì´ í¼.",en:"Hands-free dock + mop feel."},{"Dock":"Yes","Mop":"Yes","Avoidance":"High","Pets":"Good","Best":"Hands-free"},"https://global.roborock.com/","Roborock"),
          item("robot","midDock","Mid dock class",1090000,["dock","avoid"],{dock:3,avoid:2,pet:1},{ko:"ë„í¬ë¡œ ë¹„ì›€ ìë™í™”. ìœ ì§€ê´€ë¦¬ ìŠ¤íŠ¸ë ˆìŠ¤â†“",en:"Auto-empty convenience."},{"Dock":"Yes","Mop":"Optional","Avoidance":"Mid","Pets":"Good","Best":"Dock"},"https://www.ecovacs.com/","Ecovacs"),
          item("robot","mopStrong","Mop-focused class",990000,["mop","dock"],{mop:3,dock:2,avoid:2},{ko:"ë¬¼ê±¸ë ˆ ìš°ì„ . ë°”ë‹¥ ì²´ê°ì´ ëª©í‘œë¼ë©´.",en:"Mopping-first."},{"Dock":"Often","Mop":"Strong","Avoidance":"Mid","Pets":"OK","Best":"Mop"},"https://www.dreametech.com/","Dreame"),
          item("robot","valueBasic","Value suction class",590000,["value"],{value:3,mop:1,avoid:1},{ko:"ì…ë¬¸/ì‹¤ì† í¡ì… ì¤‘ì‹¬.",en:"Entry value suction."},{"Dock":"No","Mop":"Light","Avoidance":"Basic","Pets":"OK","Best":"Budget"},"https://www.mi.com/","Xiaomi")
        ]
      },

      headphones:{
        label:{ko:"í—¤ë“œí°",en:"Headphones"}, updated:"2026-02-18",
        features:[
          {id:"value",ko:"ê°€ì„±ë¹„",en:"Value"},
          {id:"anc",ko:"ANC",en:"ANC"},
          {id:"mic",ko:"ë§ˆì´í¬",en:"Mic"},
          {id:"stage",ko:"ê³µê°„ê°",en:"Soundstage"},
          {id:"wired",ko:"ìœ ì„ ",en:"Wired"}
        ],
        questions:[
          {id:"use", label:{ko:"ì£¼ ì‚¬ìš©",en:"Primary use"}, sub:{ko:"ì´ë™/í†µí™”/ì§‘ ê°ìƒ",en:"Commute/calls/home."},
            options:[
              {v:"commute",t:{ko:"ì´ë™(ANC)",en:"Commute (ANC)"},w:{anc:3}},
              {v:"work",t:{ko:"ì—…ë¬´/í†µí™”",en:"Work/Calls"},w:{mic:3}},
              {v:"home",t:{ko:"ì§‘ ê°ìƒ",en:"Home listening"},w:{stage:3,wired:2}},
              {v:"mixed",t:{ko:"ì˜¬ë¼ìš´ë“œ",en:"All-round"},w:{anc:2,mic:2}}
            ]},
          {id:"wire", label:{ko:"ìœ ì„ /ë¬´ì„ ",en:"Wired/Wireless"}, sub:{ko:"í¸ì˜ vs ì§€ì—°",en:"Convenience vs latency."},
            options:[
              {v:"wireless",t:{ko:"ë¬´ì„ ",en:"Wireless"},w:{wireless:3}},
              {v:"wired",t:{ko:"ìœ ì„ ",en:"Wired"},w:{wired:3,stage:1}},
              {v:"either",t:{ko:"ìƒê´€ì—†ìŒ",en:"Either"},w:{wired:1,wireless:1}}
            ]}
        ],
        items:[
          item("headphones","sonyWH","Sony WH-1000X class",499000,["anc","mic"],{anc:3,mic:2,wireless:3},{ko:"ì¶œí‡´ê·¼ ANC ì²´ê° ê°•í•¨. ë¬´ë‚œí•œ ì˜¬ì¸ì›.",en:"Strong commute ANC feel."},{"Type":"Over-ear","ANC":"Strong","Mic":"Good","Wired":"No","Best":"Commute"},"https://www.sony.co.kr/","Sony"),
          item("headphones","boseQC","Bose QuietComfort class",459000,["anc","mic"],{anc:3,mic:2,wireless:3},{ko:"ì°©ìš©ê°/ANC ì•ˆì •. ì˜¤ë˜ ì¨ë„ í¸ì•ˆí•¨.",en:"Comfort + stable ANC."},{"Type":"Over-ear","ANC":"Strong","Mic":"Good","Wired":"No","Best":"Comfort"},"https://www.bose.co.kr/","Bose"),
          item("headphones","valueANC","Value ANC class",199000,["value","anc"],{value:3,anc:2,wireless:3},{ko:"ê°€ì„±ë¹„ ANC ì…ë¬¸. â€˜ê°€ê²© ëŒ€ë¹„ ë§Œì¡±â€™",en:"Entry value ANC."},{"Type":"Over-ear","ANC":"Mid","Mic":"OK","Wired":"No","Best":"Value"},"https://www.anker.com/","Anker"),
          item("headphones","openBack","Open-back class",219000,["stage","wired"],{stage:3,wired:3},{ko:"ì§‘ ê°ìƒ ê³µê°„ê°. ê°œë°©í˜• ì·¨í–¥ì´ë©´.",en:"Soundstage for home."},{"Type":"Open-back","ANC":"No","Mic":"No","Wired":"Yes","Best":"Home"},"https://www.sennheiser.com/","Sennheiser")
        ]
      },

      keyboard:{
        label:{ko:"í‚¤ë³´ë“œ",en:"Keyboard"}, updated:"2026-02-18",
        features:[
          {id:"value",ko:"ê°€ì„±ë¹„",en:"Value"},
          {id:"hotswap",ko:"í•«ìŠ¤ì™‘",en:"Hot-swap"},
          {id:"wireless",ko:"ë¬´ì„ ",en:"Wireless"},
          {id:"silent",ko:"ì €ì†ŒìŒ",en:"Silent"},
          {id:"mech",ko:"ê¸°ê³„ì‹",en:"Mechanical"},
          {id:"low",ko:"ë¡œìš°í”„ë¡œíŒŒì¼",en:"Low-profile"},
          {id:"ergo",ko:"ì¸ì²´ê³µí•™",en:"Ergo"},
          {id:"qmk",ko:"QMK/VIA",en:"QMK/VIA"},
          {id:"gasket",ko:"ê°€ìŠ¤ì¼“",en:"Gasket-mount"},
          {id:"pbt",ko:"PBT í‚¤ìº¡",en:"PBT keycaps"},
          {id:"24g",ko:"2.4G",en:"2.4G"},
        ],
        questions:[
          {id:"use", label:{ko:"ì£¼ ì‚¬ìš© ëª©ì ",en:"Primary use"}, sub:{ko:"ê°€ì¤‘ì¹˜ê°€ í¬ê²Œ ë‹¬ë¼ì ¸ìš”. ì œì¼ ì¤‘ìš”.",en:"This changes weights the most."},
            options:[
              {v:"office", t:{ko:"ì‚¬ë¬´/ë¬¸ì„œ",en:"Office/docs"}, w:{silent:3,wireless:2,layout_full:1,feel_bal:1}},
              {v:"coding", t:{ko:"ì½”ë”©/ì¥ì‹œê°„ íƒ€ì´í•‘",en:"Coding/long typing"}, w:{feel_bal:2,stab:2,layout_tkl:2,layout_75:2,silent:2}},
              {v:"gaming", t:{ko:"ê²Œì„(ë°˜ì‘/ì§€ì—°)",en:"Gaming (latency)"}, w:{latency:3,mech:3,layout_tkl:1,layout_75:1}},
              {v:"mixed", t:{ko:"ì˜¬ë¼ìš´ë“œ",en:"All-round"}, w:{feel_bal:2,wireless:2,mech:2}},
            ]},
          {id:"layout", label:{ko:"ë°°ì—´(í¬ê¸°)",en:"Layout"}, sub:{ko:"ê³µê°„ vs í‚¤ ìˆ˜. ì‹¤ì‚¬ìš© ì²´ê° í¼.",en:"Space vs keys."},
            options:[
              {v:"75", t:{ko:"75% (ê¸°ëŠ¥ì—´)",en:"75% (F-row)"}, w:{layout_75:3}},
              {v:"tkl", t:{ko:"TKL (ë„˜íŒ¨ë“œ ì—†ìŒ)",en:"TKL"}, w:{layout_tkl:3}},
              {v:"full", t:{ko:"í’€ë°°ì—´ (ë„˜íŒ¨ë“œ)",en:"Full-size"}, w:{layout_full:3}},
            ]},
          {id:"connect", label:{ko:"ì—°ê²° ë°©ì‹",en:"Connection"}, sub:{ko:"2.4G=ì§€ì—°â†“ / BT=ê¸°ê¸°ì „í™˜â†‘",en:"2.4G low latency; BT easy switching."},
            options:[
              {v:"wired", t:{ko:"ìœ ì„ ",en:"Wired"}, w:{latency:3}},
              {v:"24g", t:{ko:"2.4G",en:"2.4G"}, w:{wireless:2,latency:2,"24g":3}},
              {v:"bt", t:{ko:"ë¸”ë£¨íˆ¬ìŠ¤",en:"Bluetooth"}, w:{wireless:3,multi:2}},
            ]},
          {id:"noiseTol", label:{ko:"ì†ŒìŒ ë¯¼ê°ë„",en:"Noise sensitivity"}, sub:{ko:"ì‚¬ë¬´/ì•¼ê°„ì´ë©´ ì €ì†ŒìŒì´ ê±°ì˜ ì •ë‹µ.",en:"Office/night favors silent."},
            options:[
              {v:"high", t:{ko:"ë§¤ìš° ë¯¼ê°",en:"Very sensitive"}, w:{silent:3,noise:-3,foam:2}},
              {v:"mid", t:{ko:"ë³´í†µ",en:"Moderate"}, w:{silent:2,noise:-1}},
              {v:"low", t:{ko:"ìƒê´€ì—†ìŒ",en:"Not sensitive"}, w:{noise:1,feel_crisp:1}},
            ]},
        ],
        items:[
          item("keyboard","mxkeys","Logitech MX Keys (low-profile)",149000,
            ["wireless","silent","low","value"],
            {wireless:3,silent:3,low:3,value:2,latency:1,layout_full:2,noise:-2,multi:3},
            {ko:"ì‚¬ë¬´/ë¬¸ì„œìš© â€˜ì¡°ìš©í•œ ë¬´ì„ â€™ ëŒ€í‘œ. ë¡œìš°í”„ë¡œíŒŒì¼ë¡œ ì†ëª© ë¶€ë‹´â†“",en:"Quiet wireless office staple. Low-profile comfort."},
            {"Layout":"Full-size","Switch":"Scissor","Connection":"BT/Receiver","Hot-swap":"No","Noise":"Low","Best":"Office/Docs"},
            "https://www.logitech.com/ko-kr","Logitech"
          ),
          item("keyboard","k8pro","Keychron K8 Pro (Hot-swap)",149000,
            ["mech","hotswap","wireless","pbt"],
            {mech:3,hotswap:3,wireless:2,value:2,layout_tkl:3,feel_bal:2,stab:2,qmk:2,multi:2},
            {ko:"TKL + í•«ìŠ¤ì™‘ + PBTë¡œ ì»¤ìŠ¤í…€ ì…ë¬¸ì— ê°•ë ¥.",en:"TKL + hot-swap + PBT = great custom entry."},
            {"Layout":"TKL","Connection":"BT/Wired","Hot-swap":"Yes","Keycaps":"PBT","QMK/VIA":"Often","Noise":"Mid","Best":"Coding/All-round"},
            "https://www.keychron.com/","Keychron"
          ),
          item("keyboard","gaming24g","Gaming (2.4G low latency)",179000,
            ["mech","24g","wireless"],
            {mech:3,"24g":3,wireless:2,latency:3,layout_tkl:2,feel_crisp:2,noise:1,value:1},
            {ko:"2.4G ê¸°ë°˜ ì§€ì—° ì²´ê°â†“. ê²Œì„ìš© ë°˜ì‘/ì•ˆì •ì— ì´ˆì .",en:"2.4G lowers perceived latency; gaming focused."},
            {"Layout":"TKL/75%","Connection":"2.4G/Wired","Latency":"Low","Noise":"Mid","Best":"Gaming"},
            "https://www.razer.com/","Razer"
          ),
          item("keyboard","silentMech","Silent Mechanical (office)",119000,
            ["mech","silent","value"],
            {mech:2,silent:3,value:3,noise:-2,layout_tkl:2,layout_75:2,foam:1},
            {ko:"ì €ì†ŒìŒ ìŠ¤ìœ„ì¹˜ ê¸°ë°˜ ì‹¤ì†í˜•. ì‚¬ë¬´ì‹¤/ì•¼ê°„ìš© ìµœì .",en:"Value silent-switch mechanical. Best for office/night."},
            {"Layout":"75%/TKL","Switch":"Silent","Noise":"Low","Best":"Quiet typing"},
            "https://www.leopold.co.kr/","Leopold"
          ),
        ]
      }
    };

    const CAT_ORDER=["laptop","phone","robot","headphones","keyboard"];

    // ===========================
    // App state
    // ===========================
    const defaultState = {
      cat:"laptop",
      answers:{},
      featureFilters:{},
      brandFilters:{},
      sort:"score_desc",
      search:"",
      favOnly:false,
      compare:[]
    };

    let lang = loadJSON(LS_LANG, "ko");
    let state = loadJSON(LS_STATE, defaultState);
    let favs = new Set(loadJSON(LS_FAV, []));

    // restore from URL share
    function encodeState(){
      const clean = {
        ...state,
        compare: state.compare.slice(0,3),
      };
      return btoa(unescape(encodeURIComponent(JSON.stringify(clean))));
    }
    function decodeState(s){
      try{
        const obj = JSON.parse(decodeURIComponent(escape(atob(s))));
        if(obj && typeof obj==="object") return obj;
      }catch{}
      return null;
    }
    (function restoreFromURL(){
      const url = new URL(location.href);
      const s = url.searchParams.get("s");
      if(!s) return;
      const obj = decodeState(s);
      if(obj){
        state = {...defaultState, ...obj};
        saveJSON(LS_STATE, state);
      }
    })();

    function t(){ return I18N[lang]; }

    function applyI18N(){
      const T=t();
      $("uiTitle").textContent=T.uiTitle;
      $("uiSubtitle").textContent=T.uiSubtitle;
      $("pillLocal").textContent=T.pillLocal;
      $("pillPrice").textContent=T.pillPrice;
      $("leftTitle").textContent=T.leftTitle;
      $("leftSub").textContent=T.leftSub;
      $("labSearch").textContent=T.labSearch;
      $("labSort").textContent=T.labSort;
      $("searchBox").placeholder=T.placeholderSearch;
      $("btnRun").textContent=T.btnRun;
      $("btnSample").textContent=T.btnSample;
      $("btnShare").textContent=T.btnShare;
      $("btnReset").textContent=T.btnReset;
      $("noteText").innerHTML=T.note;
      $("kCatLabel").textContent=T.kCatLabel;
      $("kUpdatedLabel").textContent=T.kUpdatedLabel;
      $("kFavLabel").textContent=T.kFavLabel;
      $("rightTitle").textContent=T.rightTitle;
      $("rightSub").textContent=T.rightSub;
      $("btnFavOnly").textContent=T.btnFavOnly;
      $("btnClearCompare").textContent=T.btnClearCompare;
      $("brandLabel").textContent=T.labels.brand;
      $("legalTitle").textContent=T.legalTitle;
      $("legalText").textContent=T.legalText;
      $("refFoot").innerHTML=T.refFoot;
      $("footerB").textContent=T.footerB;
      $("footerT").textContent=T.footerT;
      $("cmpTitle").textContent=T.cmpTitle;
      $("btnCloseDrawer").textContent=T.close;
      $("btnOpenLinks").textContent=T.openLinks;
      $("btnRemoveAll").textContent=T.removeAll;
      $("lbClose").textContent=T.close;

      const sel=$("sortSel");
      sel.querySelector('option[value="score_desc"]').textContent=T.sort.score_desc;
      sel.querySelector('option[value="price_asc"]').textContent=T.sort.price_asc;
      sel.querySelector('option[value="price_desc"]').textContent=T.sort.price_desc;
      sel.querySelector('option[value="name_asc"]').textContent=T.sort.name_asc;

      $("lang_ko").classList.toggle("active", lang==="ko");
      $("lang_en").classList.toggle("active", lang==="en");
    }

    function buildTabs(){
      const el=$("tabs");
      el.innerHTML="";
      for(const cat of CAT_ORDER){
        const btn=document.createElement("div");
        btn.className="tab"+(state.cat===cat?" active":"");
        btn.innerHTML = icon(cat) + `<span>${DATA[cat].label[lang]}</span>`;
        btn.onclick=()=>{
          state.cat=cat;
          saveJSON(LS_STATE,state);
          showToast(t().toast.moved(DATA[cat].label[lang]));
          renderAll();
        };
        el.appendChild(btn);
      }
    }

    function buildFeatureToggles(){
      const el=$("featureToggles");
      el.innerHTML="";
      const feats=DATA[state.cat].features;

      const selected = new Set(state.featureFilters[state.cat]||[]);
      function addToggle(id,label){
        const b=document.createElement("div");
        b.className="toggle"+(selected.has(id)?" active":"");
        b.textContent=label;
        b.onclick=()=>{
          if(id==="__all"){ selected.clear(); }
          else{
            if(selected.has(id)) selected.delete(id);
            else selected.add(id);
          }
          state.featureFilters[state.cat]=Array.from(selected);
          saveJSON(LS_STATE,state);
          buildFeatureToggles();
          renderResults();
        };
        el.appendChild(b);
      }
      addToggle("__all", lang==="ko"?"ì „ì²´":"All");
      for(const f of feats) addToggle(f.id, f[lang]);
    }

    function buildBrandToggles(){
      const el=$("brandToggles");
      el.innerHTML="";
      const items=DATA[state.cat].items;
      const brands = Array.from(new Set(items.map(it=>it.brand||"Other"))).sort((a,b)=>{
        const ma=getBrandMeta(a), mb=getBrandMeta(b);
        if(ma.order!==mb.order) return ma.order-mb.order;
        return a.localeCompare(b);
      });
      const prev = state.brandFilters[state.cat]||[];
      const available = new Set(brands);
      const filtered = prev.filter(b=>available.has(b));
      if(filtered.length !== prev.length){
        state.brandFilters[state.cat]=filtered;
        saveJSON(LS_STATE,state);
      }
      const selected = new Set(filtered);
      function addToggle(id,label){
        const b=document.createElement("div");
        const isActive = (id==="__all") ? (selected.size===0) : selected.has(id);
        b.className="toggle"+(isActive?" active":"");
        const meta=getBrandMeta(id);
        const linkHtml = meta.url ? ` <a class="brandLink" href="${meta.url}" target="_blank" rel="noopener">ê³µì‹</a>` : "";
        const logoHtml = meta.svg ? meta.svg : "";
        b.innerHTML = `${logoHtml} <span class="brandDot" style="--brand:${meta.color}"></span> ${label}${linkHtml}`;
        b.onclick=()=>{
          if(id==="__all"){ selected.clear(); }
          else{
            if(selected.has(id)) selected.delete(id);
            else selected.add(id);
          }
          state.brandFilters[state.cat]=Array.from(selected);
          saveJSON(LS_STATE,state);
          buildBrandToggles();
          renderResults();
        };
        const a = b.querySelector(".brandLink");
        if(a){
          a.onclick=(e)=>{ e.stopPropagation(); };
        }
        el.appendChild(b);
      }
      addToggle("__all", lang==="ko"?"ì „ì²´":"All");
      for(const b of brands) addToggle(b, b);
    }

    function buildQuestions(){
      const area=$("qArea");
      area.innerHTML="";
      const qList=DATA[state.cat].questions;
      const answers = state.answers[state.cat]||{};
      for(const q of qList){
        const wrap=document.createElement("div");
        wrap.className="q";
        wrap.innerHTML = `
          <label>${q.label[lang]}</label>
          <div class="qsub">${q.sub[lang]}</div>
          <div class="opts"></div>
        `;
        const opts=wrap.querySelector(".opts");
        for(const o of q.options){
          const div=document.createElement("div");
          div.className="opt"+(answers[q.id]===o.v?" active":"");
          div.innerHTML = `<span>${o.t[lang]}</span><small>+</small>`;
          div.onclick=()=>{
            answers[q.id]=o.v;
            state.answers[state.cat]=answers;
            saveJSON(LS_STATE,state);
            buildQuestions();
            renderResults();
          };
          opts.appendChild(div);
        }
        area.appendChild(wrap);
      }
    }

    // ===========================
    // Scoring + Reasons
    // ===========================
    function getWeightsForCat(cat){
      const answers = state.answers[cat] || {};
      const qList = DATA[cat].questions;
      const w = {};
      for(const q of qList){
        const chosen = answers[q.id];
        const opt = q.options.find(x=>x.v===chosen);
        if(!opt) continue;
        for(const [k,v] of Object.entries(opt.w||{})){
          w[k]=(w[k]||0)+v;
        }
      }
      if(Object.keys(w).length===0){
        // baseline (keeps results useful before answering)
        w.value=1; w.battery=1; w.screen=1; w.portable=1; w.camera=1;
        w.anc=1; w.mic=1; w.stage=1; w.mop=1; w.dock=1;
        w.hotswap=1; w.wireless=1; w.silent=1; w.mech=1; w.latency=1;
      }
      return w;
    }

    function scoreItem(cat, it){
      const w=getWeightsForCat(cat);
      let s=0;
      for(const [k,v] of Object.entries(w)){
        const iv = (it.vec && it.vec[k]) ? it.vec[k] : 0;
        s += iv * v;
      }
      // feature bonus
      const selected = new Set(state.featureFilters[cat]||[]);
      if(selected.size){
        let hit=0;
        for(const f of selected) if(it.features.includes(f)) hit++;
        s += hit * 3;
      }
      // search: mild boost
      const q = (state.search||"").trim().toLowerCase();
      if(q){
        const hay = (it.name+" "+(it.desc[lang]||"")+" "+Object.values(it.attrs||{}).join(" ")).toLowerCase();
        if(hay.includes(q)) s += 6;
        else s -= 2;
      }
      return s;
    }

    function topReasons(cat, it){
      const w=getWeightsForCat(cat);
      const entries = [];
      for(const [k,v] of Object.entries(w)){
        const iv = (it.vec && it.vec[k]) ? it.vec[k] : 0;
        const contrib = iv * v;
        if(contrib !== 0) entries.push([k, contrib]);
      }
      const selected = new Set(state.featureFilters[cat]||[]);
      for(const f of selected){
        if(it.features.includes(f)) entries.push(["feature:"+f, 999]);
      }
      entries.sort((a,b)=>b[1]-a[1]);
      const top = entries.slice(0,3).map(([k])=>{
        const map = {
          battery:{ko:"ë°°í„°ë¦¬",en:"Battery"},
          portable:{ko:"íœ´ëŒ€ì„±",en:"Portability"},
          screen:{ko:"í™”ë©´",en:"Display"},
          perf:{ko:"ì„±ëŠ¥",en:"Performance"},
          gpu:{ko:"ê·¸ë˜í”½",en:"Graphics"},
          mac:{ko:"macOS",en:"macOS"},
          win:{ko:"Windows",en:"Windows"},
          camera:{ko:"ì¹´ë©”ë¼",en:"Camera"},
          eco:{ko:"ìƒíƒœê³„",en:"Ecosystem"},
          compact:{ko:"ì½¤íŒ©íŠ¸",en:"Compact"},
          dock:{ko:"ë„í¬ ìë™ê´€ë¦¬",en:"Dock automation"},
          mop:{ko:"ë¬¼ê±¸ë ˆ",en:"Mopping"},
          avoid:{ko:"íšŒí”¼/ë§µí•‘",en:"Avoidance"},
          pet:{ko:"í„¸/ì—‰í‚´",en:"Hair handling"},
          anc:{ko:"ANC",en:"ANC"},
          mic:{ko:"ë§ˆì´í¬",en:"Mic"},
          stage:{ko:"ê³µê°„ê°",en:"Soundstage"},
          wired:{ko:"ìœ ì„ ",en:"Wired"},
          wireless:{ko:"ë¬´ì„ ",en:"Wireless"},
          hotswap:{ko:"í•«ìŠ¤ì™‘",en:"Hot-swap"},
          qmk:{ko:"QMK/VIA",en:"QMK/VIA"},
          gasket:{ko:"ê°€ìŠ¤ì¼“",en:"Gasket mount"},
          pbt:{ko:"PBT í‚¤ìº¡",en:"PBT keycaps"},
          ergo:{ko:"ì¸ì²´ê³µí•™",en:"Ergo layout"},
          low:{ko:"ë¡œìš°í”„ë¡œíŒŒì¼",en:"Low-profile"},
          "24g":{ko:"2.4G ì €ì§€ì—°",en:"2.4G low latency"},
          latency:{ko:"ì§€ì—° ë¯¼ê° ëŒ€ì‘",en:"Latency focused"},
          silent:{ko:"ì €ì†ŒìŒ",en:"Silent"},
          value:{ko:"ê°€ì„±ë¹„",en:"Value"},
          layout_75:{ko:"75% ë°°ì—´",en:"75% layout"},
          layout_tkl:{ko:"TKL ë°°ì—´",en:"TKL layout"},
          layout_full:{ko:"í’€ë°°ì—´",en:"Full-size"},
          multi:{ko:"ë©€í‹°ê¸°ê¸° ì „í™˜",en:"Multi-device"},
          foam:{ko:"ì†ŒìŒ ì™„í™”",en:"Noise dampening"},
          noise:{ko:"ì†ŒìŒ ì„±í–¥",en:"Noise profile"},
          feel_bal:{ko:"ë°¸ëŸ°ìŠ¤ íƒ€ê±´",en:"Balanced feel"},
          feel_crisp:{ko:"ì¨í•œ íƒ€ê±´",en:"Crisp feel"},
          stab:{ko:"ìŠ¤í…Œë¹Œ ì•ˆì •",en:"Stabilizers"}
        };
        if(k.startsWith("feature:")){
          const fid = k.split(":")[1];
          const def = DATA[cat].features.find(x=>x.id===fid);
          return def ? def[lang] : fid;
        }
        return map[k] ? map[k][lang] : k;
      });
      return top;
    }

    function itemKey(it){ return `${it.cat}:${it.id}`; }

    // ===========================
    // Compare drawer
    // ===========================
    function renderCompareDrawer(){
      const drawer=$("drawer");
      const pills=$("cmpPills");
      const wrap=$("cmpTableWrap");

      pills.innerHTML="";
      wrap.innerHTML="";

      if(state.compare.length===0){
        drawer.classList.remove("open");
        return;
      }
      drawer.classList.add("open");

      const items = state.compare.map(k=>{
        const [cat,id]=k.split(":");
        return DATA[cat]?.items.find(x=>x.id===id);
      }).filter(Boolean);

      for(const it of items){
        const p=document.createElement("div");
        p.className="cmpPill";
        p.innerHTML = `${icon(it.cat)} <span>${it.name}</span>`;
        pills.appendChild(p);
      }

      const rows = new Set(["Price"]);
      for(const it of items) Object.keys(it.attrs||{}).forEach(k=>rows.add(k));
      const rowList = Array.from(rows);

      const table=document.createElement("table");
      table.className="cmp";
      table.innerHTML = `
        <thead>
          <tr>
            <th>${lang==="ko"?"í•­ëª©":"Row"}</th>
            ${items.map(it=>`<th>${it.name}</th>`).join("")}
          </tr>
        </thead>
        <tbody>
          ${rowList.map(r=>{
            return `<tr>
              <td>${r==="Price"?(lang==="ko"?"ê°€ê²©":"Price"):r}</td>
              ${items.map(it=>{
                const v = (r==="Price") ? money(lang, it.price) : (it.attrs?.[r] ?? "-");
                return `<td>${String(v)}</td>`;
              }).join("")}
            </tr>`;
          }).join("")}
        </tbody>
      `;
      wrap.appendChild(table);
    }

    function toggleCompare(key){
      const T=t();
      const idx = state.compare.indexOf(key);
      if(idx>=0){
        state.compare.splice(idx,1);
        showToast(T.toast.compareRemove);
      }else{
        if(state.compare.length>=3){
          showToast(T.toast.compareFull);
          return;
        }
        state.compare.push(key);
        showToast(T.toast.compareAdd);
      }
      saveJSON(LS_STATE,state);
      renderCompareDrawer();
      renderResults();
    }

    // ===========================
    // Card tilt
    // ===========================
    function attachTilt(el){
      const max=10;
      function onMove(e){
        const r = el.getBoundingClientRect();
        const x = (e.clientX - r.left) / r.width;
        const y = (e.clientY - r.top) / r.height;
        const rx = (0.5 - y) * max;
        const ry = (x - 0.5) * max;
        el.style.setProperty("--mx", (x*100).toFixed(1)+"%");
        el.style.setProperty("--my", (y*100).toFixed(1)+"%");
        el.style.transform = `perspective(900px) rotateX(${rx}deg) rotateY(${ry}deg) translateY(-1px)`;
      }
      function onLeave(){
        el.style.transform = `perspective(900px) rotateX(0deg) rotateY(0deg) translateY(0px)`;
        el.style.setProperty("--mx","30%");
        el.style.setProperty("--my","15%");
      }
      el.addEventListener("mousemove", onMove);
      el.addEventListener("mouseleave", onLeave);
      el.addEventListener("touchstart", onLeave, {passive:true});
    }

    // ===========================
    // Results render
    // ===========================
    function renderResults(){
      $("kCat").textContent = DATA[state.cat].label[lang];
      $("kUpdated").textContent = DATA[state.cat].updated;
      $("kFav").textContent = String(favs.size);

      const list = DATA[state.cat].items.slice();
      const q = (state.search||"").trim().toLowerCase();
      const selected = new Set(state.featureFilters[state.cat]||[]);
      const brandSelected = new Set(state.brandFilters[state.cat]||[]);

      let scored = list.map(it=>{
        const s = scoreItem(state.cat, it);
        return {...it, _score:s};
      });

      if(selected.size){
        scored = scored.filter(it => {
          for(const f of selected){ if(it.features.includes(f)) return true; }
          return false;
        });
      }
      if(brandSelected.size){
        scored = scored.filter(it => brandSelected.has(it.brand||"Other"));
      }
      if(q){
        scored = scored.filter(it=>{
          const hay = (it.name+" "+(it.desc[lang]||"")+" "+Object.values(it.attrs||{}).join(" ")).toLowerCase();
          return hay.includes(q);
        });
      }
      if(state.favOnly){
        scored = scored.filter(it=>favs.has(itemKey(it)));
      }

      const sort = state.sort;
      if(sort==="score_desc") scored.sort((a,b)=>b._score-a._score);
      if(sort==="price_asc") scored.sort((a,b)=>(a.price||1e18)-(b.price||1e18));
      if(sort==="price_desc") scored.sort((a,b)=>(b.price||0)-(a.price||0));
      if(sort==="name_asc") scored.sort((a,b)=>a.name.localeCompare(b.name));

      const area=$("resultArea");
      area.innerHTML="";

      if(scored.length===0){
        const empty=document.createElement("div");
        empty.className="mini";
        empty.innerHTML = `
          <div style="margin-bottom:8px">${t().emptyResult}</div>
          <button class="btn ghost" type="button">${t().emptyReset}</button>
        `;
        area.appendChild(empty);
        const btn = empty.querySelector("button");
        btn.onclick=()=>{
          state.search="";
          state.featureFilters[state.cat]=[];
          state.brandFilters[state.cat]=[];
          state.favOnly=false;
          saveJSON(LS_STATE,state);
          $("searchBox").value="";
          $("btnFavOnly").classList.remove("active");
          buildFeatureToggles();
          buildBrandToggles();
          renderResults();
        };
        return;
      }

      const top = scored.slice(0, 10);
      const max = Math.max(...top.map(x=>x._score));
      const min = Math.min(...top.map(x=>x._score));

      for(const it of top){
        const key=itemKey(it);
        const isFav=favs.has(key);
        const isCmp=state.compare.includes(key);
        const link = resolveLink(it);

        const pct = (max===min) ? 80 : clamp(((it._score-min)/(max-min))*100, 4, 100);

        const v = imgVar[key] || 0;
        const imgSrc = genAppleStyleDataURL(it.cat, it.id, it.name, v);

        const reasons = topReasons(state.cat, it);

        const brandMeta = getBrandMeta(it.brand);
        const div=document.createElement("div");
        div.className="item floaty";
        div.style.setProperty("--mx","30%");
        div.style.setProperty("--my","15%");
        div.innerHTML = `
          <div class="heroImg">
            <img loading="lazy" src="${imgSrc}" alt="${it.name}">
          </div>

          <div class="heroBody">
            <h3 class="heroTitle">${it.name}</h3>
            <div class="heroPrice">${t().labels.price}: <b>${money(lang, it.price)}</b></div>
            <p class="heroDesc">${it.desc[lang]}</p>
            <div class="brandPill" style="--brand:${brandMeta.color}">
              ${brandMeta.svg || ""}
              <span class="brandDot"></span>
              <span>${it.brand || "Other"}</span>
            </div>

            <div class="scorebar"><div style="width:${pct}%"></div></div>

            <div class="itemActions">
              <a class="miniBtn" href="${link}" target="_blank" rel="noopener">ì œí’ˆ ë³´ê¸°</a>
              <button class="miniBtn star ${isFav?"active":""}" data-action="fav">â­ ì¦ê²¨ì°¾ê¸°</button>
              <button class="miniBtn cmp ${isCmp?"active":""}" data-action="cmp">ë¹„êµ</button>
            </div>
          </div>
        `;

        attachTilt(div);

        const imgEl = div.querySelector(".heroImg img");
        imgEl.addEventListener("error", ()=>{
          bumpVariation(key);
          imgEl.src = genAppleStyleDataURL(it.cat, it.id, it.name, (imgVar[key]||0));
        }, {once:true});

        div.querySelector(".heroImg").onclick = ()=>{
          const cap = (it.desc && it.desc[lang]) ? it.desc[lang] : "";
          openLightbox(it.name, imgEl.src, cap);
        };

        // actions
        div.querySelector('[data-action="fav"]').onclick=(e)=>{
          e.stopPropagation();
          if(isFav) favs.delete(key); else favs.add(key);
          saveJSON(LS_FAV, Array.from(favs));
          renderResults();
          $("kFav").textContent = String(favs.size);
        };

        div.querySelector('[data-action="cmp"]').onclick=(e)=>{
          e.stopPropagation();
          toggleCompare(key);
        };

        // AI variation button removed in simplified card

        area.appendChild(div);
      }
    }

    // ===========================
    // render all
    // ===========================
    function renderAll(){
      applyI18N();
      buildTabs();
      buildFeatureToggles();
      buildBrandToggles();
      buildQuestions();
      $("sortSel").value = state.sort || "score_desc";
      $("searchBox").value = state.search || "";
      renderCompareDrawer();
      renderResults();
    }

    // ===========================
    // events
    // ===========================
    $("lang_ko").onclick=()=>{ lang="ko"; saveJSON(LS_LANG,lang); renderAll(); };
    $("lang_en").onclick=()=>{ lang="en"; saveJSON(LS_LANG,lang); renderAll(); };

    $("btnRun").onclick=()=>{ showToast(t().toast.ran); renderResults(); };

    $("btnSample").onclick=()=>{
      const qs=DATA[state.cat].questions;
      const a={};
      for(const q of qs) a[q.id]=q.options[0].v;
      state.answers[state.cat]=a;
      saveJSON(LS_STATE,state);
      buildQuestions();
      renderResults();
      showToast(t().toast.sample);
    };

    $("btnShare").onclick=async()=>{
      const url = new URL(location.href);
      url.searchParams.set("s", encodeState());
      const share = url.toString();
      try{
        await navigator.clipboard.writeText(share);
        showToast(t().toast.shared);
      }catch{
        showToast(t().toast.shareFail);
      }
      history.replaceState({}, "", share);
    };

    $("btnReset").onclick=()=>{
      state = JSON.parse(JSON.stringify(defaultState));
      saveJSON(LS_STATE,state);
      renderAll();
      showToast(t().toast.reset);
    };

    $("sortSel").onchange=(e)=>{
      state.sort=e.target.value;
      saveJSON(LS_STATE,state);
      renderResults();
    };

    $("searchBox").oninput=(e)=>{
      state.search=e.target.value;
      saveJSON(LS_STATE,state);
      renderResults();
    };

    $("btnFavOnly").onclick=()=>{
      state.favOnly=!state.favOnly;
      saveJSON(LS_STATE,state);
      showToast(state.favOnly ? t().toast.favOnlyOn : t().toast.favOnlyOff);
      renderResults();
    };

    $("btnClearCompare").onclick=()=>{
      state.compare=[];
      saveJSON(LS_STATE,state);
      renderCompareDrawer();
      renderResults();
      showToast(t().toast.compareCleared);
    };

    $("btnCloseDrawer").onclick=()=>{ $("drawer").classList.remove("open"); };
    $("btnRemoveAll").onclick=()=>{
      state.compare=[];
      saveJSON(LS_STATE,state);
      renderCompareDrawer();
      renderResults();
      showToast(t().toast.compareCleared);
    };
    $("btnOpenLinks").onclick=()=>{
      const items = state.compare.map(k=>{
        const [cat,id]=k.split(":");
        return DATA[cat]?.items.find(x=>x.id===id);
      }).filter(Boolean);
      for(const it of items){
        window.open(resolveLink(it), "_blank", "noopener");
      }
      showToast(t().toast.opened);
    };

    $("lbClose").onclick = closeLightbox;
    $("lightbox").onclick = (e)=>{ if(e.target.id==="lightbox") closeLightbox(); };
    window.addEventListener("keydown",(e)=>{ if(e.key==="Escape") closeLightbox(); });

    // boot
    if(!CAT_ORDER.includes(state.cat)) state.cat="laptop";
    renderAll();
  </script>
</body>
</html>
